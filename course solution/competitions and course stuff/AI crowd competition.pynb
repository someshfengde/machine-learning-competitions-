{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"AI crowd competition.pynb","provenance":[],"collapsed_sections":[],"authorship_tag":"ABX9TyPHLgahTltf7zR7x1ZL39JK"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"3daa64f0f8e342d291a62b2a60b8045f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_cc717baa45204ab9ab1ff60c893a7440","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_26e93f525f1e4b48ad9f89842d20dc91","IPY_MODEL_15236952ae5e4aa58d5a8a462e771aa7","IPY_MODEL_013e8ff2dbb141e7bd78cffaf352d1be"]}},"cc717baa45204ab9ab1ff60c893a7440":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"26e93f525f1e4b48ad9f89842d20dc91":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_147eaca2f816483c8fc50056cbdc02a0","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"test.zip: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c97e833321394b66b813a992d56bc291"}},"15236952ae5e4aa58d5a8a462e771aa7":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_718b815f5ea34a93aa788b91063df778","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":316029680,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":316029680,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_91b6c9347be14b7c8ca6809a536dc2bf"}},"013e8ff2dbb141e7bd78cffaf352d1be":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_a5872cc857d541b5a44c0efd1c22ce5e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 316M/316M [00:42&lt;00:00, 8.09MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c5dab45207544a21ba3a8a57c81ffea0"}},"147eaca2f816483c8fc50056cbdc02a0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"c97e833321394b66b813a992d56bc291":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"718b815f5ea34a93aa788b91063df778":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"91b6c9347be14b7c8ca6809a536dc2bf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a5872cc857d541b5a44c0efd1c22ce5e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"c5dab45207544a21ba3a8a57c81ffea0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"99a08a5682d6459eaf5e44a3161856f8":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_c3c7d723707545acbe6c59b7d0eed218","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_828fed7126014bfdafefd00989a1666b","IPY_MODEL_d308b930a6734a4f9d3d676a5a5f30b9","IPY_MODEL_da096fb1697e462c92a1e3158a9b59b0"]}},"c3c7d723707545acbe6c59b7d0eed218":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"828fed7126014bfdafefd00989a1666b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ff142f814b5f4d79a8e4d6b54a85d98b","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"train.zip: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8d202f1c822140c48a1bb693f21baf90"}},"d308b930a6734a4f9d3d676a5a5f30b9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_a50611b558cb41bbb70912b785491e1f","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":401861013,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":401861013,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_fc65e9f1f05240738c6697f4001ce54b"}},"da096fb1697e462c92a1e3158a9b59b0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_dbe0403a2c014c98b58f15505660dc23","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 402M/402M [00:17&lt;00:00, 24.4MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d4df8aaeeb74401da04f7885ff29e616"}},"ff142f814b5f4d79a8e4d6b54a85d98b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"8d202f1c822140c48a1bb693f21baf90":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a50611b558cb41bbb70912b785491e1f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"fc65e9f1f05240738c6697f4001ce54b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"dbe0403a2c014c98b58f15505660dc23":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"d4df8aaeeb74401da04f7885ff29e616":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Kk0rByfHa04L","executionInfo":{"status":"ok","timestamp":1627381143493,"user_tz":-330,"elapsed":13,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}},"outputId":"d95b1194-57b3-48d8-c412-fe9516f314ac"},"source":["!nvidia-smi"],"execution_count":1,"outputs":[{"output_type":"stream","text":["Tue Jul 27 10:19:02 2021       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 470.42.01    Driver Version: 460.32.03    CUDA Version: 11.2     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   38C    P8     9W /  70W |      0MiB / 15109MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":974,"referenced_widgets":["3daa64f0f8e342d291a62b2a60b8045f","cc717baa45204ab9ab1ff60c893a7440","26e93f525f1e4b48ad9f89842d20dc91","15236952ae5e4aa58d5a8a462e771aa7","013e8ff2dbb141e7bd78cffaf352d1be","147eaca2f816483c8fc50056cbdc02a0","c97e833321394b66b813a992d56bc291","718b815f5ea34a93aa788b91063df778","91b6c9347be14b7c8ca6809a536dc2bf","a5872cc857d541b5a44c0efd1c22ce5e","c5dab45207544a21ba3a8a57c81ffea0","99a08a5682d6459eaf5e44a3161856f8","c3c7d723707545acbe6c59b7d0eed218","828fed7126014bfdafefd00989a1666b","d308b930a6734a4f9d3d676a5a5f30b9","da096fb1697e462c92a1e3158a9b59b0","ff142f814b5f4d79a8e4d6b54a85d98b","8d202f1c822140c48a1bb693f21baf90","a50611b558cb41bbb70912b785491e1f","fc65e9f1f05240738c6697f4001ce54b","dbe0403a2c014c98b58f15505660dc23","d4df8aaeeb74401da04f7885ff29e616"]},"id":"DQU7BwsVaOxH","executionInfo":{"status":"ok","timestamp":1627381226682,"user_tz":-330,"elapsed":83193,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}},"outputId":"e9c83967-4113-4c93-a017-69fe589ab469"},"source":["!pip install aicrowd-cli\n","\n","%load_ext aicrowd.magic\n","%aicrowd login\n","# Downloading the Dataset\n","!rm -rf data\n","!mkdir data\n","%aicrowd ds dl -c tree-segmentation -o data\n","!unzip data/train.zip -d data/train > /dev/null\n","!unzip data/test.zip -d data/test > /dev/null\n"],"execution_count":2,"outputs":[{"output_type":"stream","text":["Collecting aicrowd-cli\n","  Downloading aicrowd_cli-0.1.8-py3-none-any.whl (43 kB)\n","\u001b[?25l\r\u001b[K     |███████▋                        | 10 kB 31.9 MB/s eta 0:00:01\r\u001b[K     |███████████████▎                | 20 kB 21.4 MB/s eta 0:00:01\r\u001b[K     |██████████████████████▉         | 30 kB 16.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▌ | 40 kB 14.7 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████████| 43 kB 989 kB/s \n","\u001b[?25hCollecting rich<11,>=10.0.0\n","  Downloading rich-10.6.0-py3-none-any.whl (208 kB)\n","\u001b[K     |████████████████████████████████| 208 kB 11.7 MB/s \n","\u001b[?25hCollecting tqdm<5,>=4.56.0\n","  Downloading tqdm-4.61.2-py2.py3-none-any.whl (76 kB)\n","\u001b[K     |████████████████████████████████| 76 kB 5.3 MB/s \n","\u001b[?25hRequirement already satisfied: toml<1,>=0.10.2 in /usr/local/lib/python3.7/dist-packages (from aicrowd-cli) (0.10.2)\n","Collecting requests-toolbelt<1,>=0.9.1\n","  Downloading requests_toolbelt-0.9.1-py2.py3-none-any.whl (54 kB)\n","\u001b[K     |████████████████████████████████| 54 kB 3.8 MB/s \n","\u001b[?25hCollecting GitPython==3.1.18\n","  Downloading GitPython-3.1.18-py3-none-any.whl (170 kB)\n","\u001b[K     |████████████████████████████████| 170 kB 54.6 MB/s \n","\u001b[?25hCollecting requests<3,>=2.25.1\n","  Downloading requests-2.26.0-py2.py3-none-any.whl (62 kB)\n","\u001b[K     |████████████████████████████████| 62 kB 1.0 MB/s \n","\u001b[?25hRequirement already satisfied: click<8,>=7.1.2 in /usr/local/lib/python3.7/dist-packages (from aicrowd-cli) (7.1.2)\n","Collecting gitdb<5,>=4.0.1\n","  Downloading gitdb-4.0.7-py3-none-any.whl (63 kB)\n","\u001b[K     |████████████████████████████████| 63 kB 2.2 MB/s \n","\u001b[?25hRequirement already satisfied: typing-extensions>=3.7.4.0 in /usr/local/lib/python3.7/dist-packages (from GitPython==3.1.18->aicrowd-cli) (3.7.4.3)\n","Collecting smmap<5,>=3.0.1\n","  Downloading smmap-4.0.0-py2.py3-none-any.whl (24 kB)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests<3,>=2.25.1->aicrowd-cli) (1.24.3)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests<3,>=2.25.1->aicrowd-cli) (2.10)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.7/dist-packages (from requests<3,>=2.25.1->aicrowd-cli) (2.0.2)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests<3,>=2.25.1->aicrowd-cli) (2021.5.30)\n","Collecting commonmark<0.10.0,>=0.9.0\n","  Downloading commonmark-0.9.1-py2.py3-none-any.whl (51 kB)\n","\u001b[K     |████████████████████████████████| 51 kB 5.3 MB/s \n","\u001b[?25hRequirement already satisfied: pygments<3.0.0,>=2.6.0 in /usr/local/lib/python3.7/dist-packages (from rich<11,>=10.0.0->aicrowd-cli) (2.6.1)\n","Collecting colorama<0.5.0,>=0.4.0\n","  Downloading colorama-0.4.4-py2.py3-none-any.whl (16 kB)\n","Installing collected packages: smmap, requests, gitdb, commonmark, colorama, tqdm, rich, requests-toolbelt, GitPython, aicrowd-cli\n","  Attempting uninstall: requests\n","    Found existing installation: requests 2.23.0\n","    Uninstalling requests-2.23.0:\n","      Successfully uninstalled requests-2.23.0\n","  Attempting uninstall: tqdm\n","    Found existing installation: tqdm 4.41.1\n","    Uninstalling tqdm-4.41.1:\n","      Successfully uninstalled tqdm-4.41.1\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","google-colab 1.0.0 requires requests~=2.23.0, but you have requests 2.26.0 which is incompatible.\n","datascience 0.10.6 requires folium==0.2.1, but you have folium 0.8.3 which is incompatible.\u001b[0m\n","Successfully installed GitPython-3.1.18 aicrowd-cli-0.1.8 colorama-0.4.4 commonmark-0.9.1 gitdb-4.0.7 requests-2.26.0 requests-toolbelt-0.9.1 rich-10.6.0 smmap-4.0.0 tqdm-4.61.2\n","Please login here: \u001b[34m\u001b[1m\u001b[4mhttps://api.aicrowd.com/auth/LbOG_0cQfJW8CfxxQ5jxf8puqvZkNhGL4Phr6g8GajM\u001b[0m\n","\u001b[32mAPI Key valid\u001b[0m\n","\u001b[32mSaved API Key successfully!\u001b[0m\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"3daa64f0f8e342d291a62b2a60b8045f","version_minor":0,"version_major":2},"text/plain":["test.zip:   0%|          | 0.00/316M [00:00<?, ?B/s]"]},"metadata":{"tags":[]}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"99a08a5682d6459eaf5e44a3161856f8","version_minor":0,"version_major":2},"text/plain":["train.zip:   0%|          | 0.00/402M [00:00<?, ?B/s]"]},"metadata":{"tags":[]}}]},{"cell_type":"code","metadata":{"id":"C2v1QQJFa_aZ","executionInfo":{"status":"ok","timestamp":1627381227961,"user_tz":-330,"elapsed":1284,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}}},"source":["import os \n","import tensorflow as tf \n","import pandas as pd \n","import numpy as np \n","import matplotlib.pyplot as plt\n"],"execution_count":3,"outputs":[]},{"cell_type":"code","metadata":{"id":"lO0QlSQ3bvog","executionInfo":{"status":"ok","timestamp":1627381227962,"user_tz":-330,"elapsed":9,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}}},"source":["train_image_paths = sorted(os.listdir('/content/data/train/image'))"],"execution_count":4,"outputs":[]},{"cell_type":"code","metadata":{"id":"f9mm1SLaiZYv","executionInfo":{"status":"ok","timestamp":1627381227963,"user_tz":-330,"elapsed":8,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}}},"source":["for i in range(len(train_image_paths)):\n","  train_image_paths[i]= '/content/data/train/image/' +train_image_paths[i] "],"execution_count":5,"outputs":[]},{"cell_type":"code","metadata":{"id":"3TmnBUmFiS7V","executionInfo":{"status":"ok","timestamp":1627381234212,"user_tz":-330,"elapsed":5683,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}}},"source":["train_image_paths = tf.data.Dataset.from_tensor_slices(train_image_paths)"],"execution_count":6,"outputs":[]},{"cell_type":"code","metadata":{"id":"WraMORPLjtUf","executionInfo":{"status":"ok","timestamp":1627381234214,"user_tz":-330,"elapsed":25,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}}},"source":["train_image_paths = train_image_paths"],"execution_count":7,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":225},"id":"m6GOrUkslEdj","executionInfo":{"status":"error","timestamp":1627381234802,"user_tz":-330,"elapsed":612,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}},"outputId":"cc16b166-e177-4392-db9e-b2562c937a0c"},"source":["len(train_image_paths), len(train_images_labels)"],"execution_count":8,"outputs":[{"output_type":"display_data","data":{"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #ff0000; text-decoration-color: #ff0000\">╭──────────────────────────── </span><span style=\"color: #800000; text-decoration-color: #800000; font-weight: bold\">Traceback </span><span style=\"color: #bf7f7f; text-decoration-color: #bf7f7f; font-weight: bold\">(most recent call last)</span><span style=\"color: #ff0000; text-decoration-color: #ff0000\"> ────────────────────────────╮</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/IPython/core/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">interactiveshell.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">2882</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">run_code</span>  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2879 │   │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">try</span>:                                                                   <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2880 │   │   │   │   </span><span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>.hooks.pre_run_code_hook()                                     <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2881 │   │   │   │   #rprint('Running code', repr(code_obj)) # dbg</span>                      <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>2882 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   │   │   </span>exec(code_obj, <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>.user_global_ns, <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>.user_ns)                  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2883 │   │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">finally</span>:                                                               <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2884 │   │   │   │   # Reset our crash handler in place</span>                                 <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2885 │   │   │   │   </span>sys.excepthook = old_excepthook                                    <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #808000; text-decoration-color: #808000\">&lt;ipython-input-8-27d9bf4964d5&gt;</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">1</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">&lt;module&gt;</span>                                              <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">╰───────────────────────────────────────────────────────────────────────────────────────────╯</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000; font-weight: bold\">NameError: </span>name <span style=\"color: #008000; text-decoration-color: #008000\">'train_images_labels'</span> is not defined\n","</pre>\n"],"text/plain":["\u001b[91m╭─\u001b[0m\u001b[91m─────────────────────────── \u001b[0m\u001b[1;31mTraceback \u001b[0m\u001b[1;2;31m(most recent call last)\u001b[0m\u001b[91m ───────────────────────────\u001b[0m\u001b[91m─╮\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/IPython/core/\u001b[0m\u001b[1;33minteractiveshell.py\u001b[0m:\u001b[94m2882\u001b[0m in \u001b[92mrun_code\u001b[0m  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2879 \u001b[0m\u001b[2m│   │   │   \u001b[0m\u001b[94mtry\u001b[0m:                                                                   \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2880 \u001b[0m\u001b[2m│   │   │   │   \u001b[0m\u001b[96mself\u001b[0m.hooks.pre_run_code_hook()                                     \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2881 \u001b[0m\u001b[2m│   │   │   │   \u001b[0m\u001b[2m#rprint('Running code', repr(code_obj)) # dbg\u001b[0m                      \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m2882 \u001b[2m│   │   │   │   \u001b[0mexec(code_obj, \u001b[96mself\u001b[0m.user_global_ns, \u001b[96mself\u001b[0m.user_ns)                  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2883 \u001b[0m\u001b[2m│   │   │   \u001b[0m\u001b[94mfinally\u001b[0m:                                                               \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2884 \u001b[0m\u001b[2m│   │   │   │   \u001b[0m\u001b[2m# Reset our crash handler in place\u001b[0m                                 \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2885 \u001b[0m\u001b[2m│   │   │   │   \u001b[0msys.excepthook = old_excepthook                                    \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[33m<ipython-input-8-27d9bf4964d5>\u001b[0m:\u001b[94m1\u001b[0m in \u001b[92m<module>\u001b[0m                                              \u001b[91m│\u001b[0m\n","\u001b[91m╰───────────────────────────────────────────────────────────────────────────────────────────╯\u001b[0m\n","\u001b[1;91mNameError: \u001b[0mname \u001b[32m'train_images_labels'\u001b[0m is not defined\n"]},"metadata":{"tags":[]}}]},{"cell_type":"code","metadata":{"id":"blgzAVm-b0yd","executionInfo":{"status":"aborted","timestamp":1627381234792,"user_tz":-330,"elapsed":599,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}}},"source":["train_image_labels = sorted(os.listdir('/content/data/train/segmentation'))\n","for i in range(len(train_images_labels)):\n","  train_image_labels[i]= '/content/data/train/segmentation/' +train_image_labels[i] "],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"n0FP7yxslVLS","executionInfo":{"status":"aborted","timestamp":1627381234794,"user_tz":-330,"elapsed":601,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}}},"source":["train_image_labels = tf.data.Dataset.from_tensor_slices(train_image_labels)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"eh5T9__IeUyr","executionInfo":{"status":"aborted","timestamp":1627381234797,"user_tz":-330,"elapsed":9,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}}},"source":["import tensorflow_hub as hub "],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"_P6kfFMVfwof","executionInfo":{"status":"aborted","timestamp":1627381234798,"user_tz":-330,"elapsed":10,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}}},"source":["def process_path(file_path):\n","  img = tf.io.read_file(file_path)\n","  img = decode_img(img)\n","  return img\n","\n","def decode_img(img):\n","  img = tf.io.decode_jpeg(img, channels=3)\n","  return tf.image.resize(img, [224,224])\n","\n","train_dataset_images = train_image_paths.map(process_path)\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"Yxe266psdi8F","executionInfo":{"status":"aborted","timestamp":1627381234799,"user_tz":-330,"elapsed":10,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}}},"source":["train_dataset_labels = train_image_labels.map(process_path)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"IXII93zWdtsh","executionInfo":{"status":"aborted","timestamp":1627381234799,"user_tz":-330,"elapsed":10,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}}},"source":["train_dataset = tf.data.Dataset.zip((train_dataset_images,train_dataset_labels))"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"18N-Qf41tcVF","executionInfo":{"status":"aborted","timestamp":1627381234800,"user_tz":-330,"elapsed":11,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}}},"source":["train_dataset"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"T-OYpwy_b7Iu","executionInfo":{"status":"aborted","timestamp":1627381234801,"user_tz":-330,"elapsed":12,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}}},"source":["base_layer = hub.KerasLayer('https://tfhub.dev/nvidia/unet/industrial/class_6/1')"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"ckYpiZgnoozx","executionInfo":{"status":"aborted","timestamp":1627381234801,"user_tz":-330,"elapsed":12,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}}},"source":["sample = train_image_paths.take(1)\n","for x in sample:\n","  print(x)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"d9GQ6CxxrwJu","executionInfo":{"status":"aborted","timestamp":1627381234802,"user_tz":-330,"elapsed":13,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}}},"source":["base_layer('/content/data/train/image/0.jpg')"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"8n8SOx9Qnia6","executionInfo":{"status":"aborted","timestamp":1627381234802,"user_tz":-330,"elapsed":12,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}}},"source":["for layer in base_layer:\n","  print(layer,layer.shape)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ZqvFpG74dxT8","executionInfo":{"status":"ok","timestamp":1627150485546,"user_tz":-330,"elapsed":1201,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}},"outputId":"249df5e5-d9b7-4c22-9476-f434db7228cc"},"source":["# inputs = tf.keras.layers.Input(shape = (224,224,3))\n","\n","# # x = tf.keras.preprocessing.image.smart_resize(inputs,size = (512,512))\n","# x = base_layer(inputs)\n","# outputs = x \n","# model = tf.keras.Model(inputs,outputs)\n","from tensorflow.keras import layers\n","from tensorflow import keras\n","\n","def get_model(img_size, num_classes):\n","    inputs = keras.Input(shape=img_size + (3,))\n","\n","    ### [First half of the network: downsampling inputs] ###\n","\n","    # Entry block\n","    x = layers.Conv2D(32, 3, strides=2, padding=\"same\")(inputs)\n","    x = layers.BatchNormalization()(x)\n","    x = layers.Activation(\"relu\")(x)\n","\n","    previous_block_activation = x  # Set aside residual\n","\n","    # Blocks 1, 2, 3 are identical apart from the feature depth.\n","    for filters in [64, 128, 256]:\n","        x = layers.Activation(\"relu\")(x)\n","        x = layers.SeparableConv2D(filters, 3, padding=\"same\")(x)\n","        x = layers.BatchNormalization()(x)\n","\n","        x = layers.Activation(\"relu\")(x)\n","        x = layers.SeparableConv2D(filters, 3, padding=\"same\")(x)\n","        x = layers.BatchNormalization()(x)\n","\n","        x = layers.MaxPooling2D(3, strides=2, padding=\"same\")(x)\n","\n","        # Project residual\n","        residual = layers.Conv2D(filters, 1, strides=2, padding=\"same\")(\n","            previous_block_activation\n","        )\n","        x = layers.add([x, residual])  # Add back residual\n","        previous_block_activation = x  # Set aside next residual\n","\n","    ### [Second half of the network: upsampling inputs] ###\n","\n","    for filters in [256, 128, 64, 32]:\n","        x = layers.Activation(\"relu\")(x)\n","        x = layers.Conv2DTranspose(filters, 3, padding=\"same\")(x)\n","        x = layers.BatchNormalization()(x)\n","\n","        x = layers.Activation(\"relu\")(x)\n","        x = layers.Conv2DTranspose(filters, 3, padding=\"same\")(x)\n","        x = layers.BatchNormalization()(x)\n","\n","        x = layers.UpSampling2D(2)(x)\n","\n","        # Project residual\n","        residual = layers.UpSampling2D(2)(previous_block_activation)\n","        residual = layers.Conv2D(filters, 1, padding=\"same\")(residual)\n","        x = layers.add([x, residual])  # Add back residual\n","        previous_block_activation = x  # Set aside next residual\n","\n","    # Add a per-pixel classification layer\n","    outputs = layers.Conv2D(num_classes, 3, activation=\"softmax\", padding=\"same\")(x)\n","\n","    # Define the model\n","    model = keras.Model(inputs, outputs)\n","    return model\n","\n","\n","# Free up RAM in case the model definition cells were run multiple times\n","# keras.backend.clear_session()\n","\n","# Build model\n","model = get_model((224,224), (3))\n","model.summary()\n"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Model: \"model_2\"\n","__________________________________________________________________________________________________\n","Layer (type)                    Output Shape         Param #     Connected to                     \n","==================================================================================================\n","input_27 (InputLayer)           [(None, 224, 224, 3) 0                                            \n","__________________________________________________________________________________________________\n","conv2d_11 (Conv2D)              (None, 112, 112, 32) 896         input_27[0][0]                   \n","__________________________________________________________________________________________________\n","batch_normalization_16 (BatchNo (None, 112, 112, 32) 128         conv2d_11[0][0]                  \n","__________________________________________________________________________________________________\n","activation_17 (Activation)      (None, 112, 112, 32) 0           batch_normalization_16[0][0]     \n","__________________________________________________________________________________________________\n","activation_18 (Activation)      (None, 112, 112, 32) 0           activation_17[0][0]              \n","__________________________________________________________________________________________________\n","separable_conv2d_7 (SeparableCo (None, 112, 112, 64) 2400        activation_18[0][0]              \n","__________________________________________________________________________________________________\n","batch_normalization_17 (BatchNo (None, 112, 112, 64) 256         separable_conv2d_7[0][0]         \n","__________________________________________________________________________________________________\n","activation_19 (Activation)      (None, 112, 112, 64) 0           batch_normalization_17[0][0]     \n","__________________________________________________________________________________________________\n","separable_conv2d_8 (SeparableCo (None, 112, 112, 64) 4736        activation_19[0][0]              \n","__________________________________________________________________________________________________\n","batch_normalization_18 (BatchNo (None, 112, 112, 64) 256         separable_conv2d_8[0][0]         \n","__________________________________________________________________________________________________\n","max_pooling2d_3 (MaxPooling2D)  (None, 56, 56, 64)   0           batch_normalization_18[0][0]     \n","__________________________________________________________________________________________________\n","conv2d_12 (Conv2D)              (None, 56, 56, 64)   2112        activation_17[0][0]              \n","__________________________________________________________________________________________________\n","add_7 (Add)                     (None, 56, 56, 64)   0           max_pooling2d_3[0][0]            \n","                                                                 conv2d_12[0][0]                  \n","__________________________________________________________________________________________________\n","activation_20 (Activation)      (None, 56, 56, 64)   0           add_7[0][0]                      \n","__________________________________________________________________________________________________\n","separable_conv2d_9 (SeparableCo (None, 56, 56, 128)  8896        activation_20[0][0]              \n","__________________________________________________________________________________________________\n","batch_normalization_19 (BatchNo (None, 56, 56, 128)  512         separable_conv2d_9[0][0]         \n","__________________________________________________________________________________________________\n","activation_21 (Activation)      (None, 56, 56, 128)  0           batch_normalization_19[0][0]     \n","__________________________________________________________________________________________________\n","separable_conv2d_10 (SeparableC (None, 56, 56, 128)  17664       activation_21[0][0]              \n","__________________________________________________________________________________________________\n","batch_normalization_20 (BatchNo (None, 56, 56, 128)  512         separable_conv2d_10[0][0]        \n","__________________________________________________________________________________________________\n","max_pooling2d_4 (MaxPooling2D)  (None, 28, 28, 128)  0           batch_normalization_20[0][0]     \n","__________________________________________________________________________________________________\n","conv2d_13 (Conv2D)              (None, 28, 28, 128)  8320        add_7[0][0]                      \n","__________________________________________________________________________________________________\n","add_8 (Add)                     (None, 28, 28, 128)  0           max_pooling2d_4[0][0]            \n","                                                                 conv2d_13[0][0]                  \n","__________________________________________________________________________________________________\n","activation_22 (Activation)      (None, 28, 28, 128)  0           add_8[0][0]                      \n","__________________________________________________________________________________________________\n","separable_conv2d_11 (SeparableC (None, 28, 28, 256)  34176       activation_22[0][0]              \n","__________________________________________________________________________________________________\n","batch_normalization_21 (BatchNo (None, 28, 28, 256)  1024        separable_conv2d_11[0][0]        \n","__________________________________________________________________________________________________\n","activation_23 (Activation)      (None, 28, 28, 256)  0           batch_normalization_21[0][0]     \n","__________________________________________________________________________________________________\n","separable_conv2d_12 (SeparableC (None, 28, 28, 256)  68096       activation_23[0][0]              \n","__________________________________________________________________________________________________\n","batch_normalization_22 (BatchNo (None, 28, 28, 256)  1024        separable_conv2d_12[0][0]        \n","__________________________________________________________________________________________________\n","max_pooling2d_5 (MaxPooling2D)  (None, 14, 14, 256)  0           batch_normalization_22[0][0]     \n","__________________________________________________________________________________________________\n","conv2d_14 (Conv2D)              (None, 14, 14, 256)  33024       add_8[0][0]                      \n","__________________________________________________________________________________________________\n","add_9 (Add)                     (None, 14, 14, 256)  0           max_pooling2d_5[0][0]            \n","                                                                 conv2d_14[0][0]                  \n","__________________________________________________________________________________________________\n","activation_24 (Activation)      (None, 14, 14, 256)  0           add_9[0][0]                      \n","__________________________________________________________________________________________________\n","conv2d_transpose_8 (Conv2DTrans (None, 14, 14, 256)  590080      activation_24[0][0]              \n","__________________________________________________________________________________________________\n","batch_normalization_23 (BatchNo (None, 14, 14, 256)  1024        conv2d_transpose_8[0][0]         \n","__________________________________________________________________________________________________\n","activation_25 (Activation)      (None, 14, 14, 256)  0           batch_normalization_23[0][0]     \n","__________________________________________________________________________________________________\n","conv2d_transpose_9 (Conv2DTrans (None, 14, 14, 256)  590080      activation_25[0][0]              \n","__________________________________________________________________________________________________\n","batch_normalization_24 (BatchNo (None, 14, 14, 256)  1024        conv2d_transpose_9[0][0]         \n","__________________________________________________________________________________________________\n","up_sampling2d_9 (UpSampling2D)  (None, 28, 28, 256)  0           add_9[0][0]                      \n","__________________________________________________________________________________________________\n","up_sampling2d_8 (UpSampling2D)  (None, 28, 28, 256)  0           batch_normalization_24[0][0]     \n","__________________________________________________________________________________________________\n","conv2d_15 (Conv2D)              (None, 28, 28, 256)  65792       up_sampling2d_9[0][0]            \n","__________________________________________________________________________________________________\n","add_10 (Add)                    (None, 28, 28, 256)  0           up_sampling2d_8[0][0]            \n","                                                                 conv2d_15[0][0]                  \n","__________________________________________________________________________________________________\n","activation_26 (Activation)      (None, 28, 28, 256)  0           add_10[0][0]                     \n","__________________________________________________________________________________________________\n","conv2d_transpose_10 (Conv2DTran (None, 28, 28, 128)  295040      activation_26[0][0]              \n","__________________________________________________________________________________________________\n","batch_normalization_25 (BatchNo (None, 28, 28, 128)  512         conv2d_transpose_10[0][0]        \n","__________________________________________________________________________________________________\n","activation_27 (Activation)      (None, 28, 28, 128)  0           batch_normalization_25[0][0]     \n","__________________________________________________________________________________________________\n","conv2d_transpose_11 (Conv2DTran (None, 28, 28, 128)  147584      activation_27[0][0]              \n","__________________________________________________________________________________________________\n","batch_normalization_26 (BatchNo (None, 28, 28, 128)  512         conv2d_transpose_11[0][0]        \n","__________________________________________________________________________________________________\n","up_sampling2d_11 (UpSampling2D) (None, 56, 56, 256)  0           add_10[0][0]                     \n","__________________________________________________________________________________________________\n","up_sampling2d_10 (UpSampling2D) (None, 56, 56, 128)  0           batch_normalization_26[0][0]     \n","__________________________________________________________________________________________________\n","conv2d_16 (Conv2D)              (None, 56, 56, 128)  32896       up_sampling2d_11[0][0]           \n","__________________________________________________________________________________________________\n","add_11 (Add)                    (None, 56, 56, 128)  0           up_sampling2d_10[0][0]           \n","                                                                 conv2d_16[0][0]                  \n","__________________________________________________________________________________________________\n","activation_28 (Activation)      (None, 56, 56, 128)  0           add_11[0][0]                     \n","__________________________________________________________________________________________________\n","conv2d_transpose_12 (Conv2DTran (None, 56, 56, 64)   73792       activation_28[0][0]              \n","__________________________________________________________________________________________________\n","batch_normalization_27 (BatchNo (None, 56, 56, 64)   256         conv2d_transpose_12[0][0]        \n","__________________________________________________________________________________________________\n","activation_29 (Activation)      (None, 56, 56, 64)   0           batch_normalization_27[0][0]     \n","__________________________________________________________________________________________________\n","conv2d_transpose_13 (Conv2DTran (None, 56, 56, 64)   36928       activation_29[0][0]              \n","__________________________________________________________________________________________________\n","batch_normalization_28 (BatchNo (None, 56, 56, 64)   256         conv2d_transpose_13[0][0]        \n","__________________________________________________________________________________________________\n","up_sampling2d_13 (UpSampling2D) (None, 112, 112, 128 0           add_11[0][0]                     \n","__________________________________________________________________________________________________\n","up_sampling2d_12 (UpSampling2D) (None, 112, 112, 64) 0           batch_normalization_28[0][0]     \n","__________________________________________________________________________________________________\n","conv2d_17 (Conv2D)              (None, 112, 112, 64) 8256        up_sampling2d_13[0][0]           \n","__________________________________________________________________________________________________\n","add_12 (Add)                    (None, 112, 112, 64) 0           up_sampling2d_12[0][0]           \n","                                                                 conv2d_17[0][0]                  \n","__________________________________________________________________________________________________\n","activation_30 (Activation)      (None, 112, 112, 64) 0           add_12[0][0]                     \n","__________________________________________________________________________________________________\n","conv2d_transpose_14 (Conv2DTran (None, 112, 112, 32) 18464       activation_30[0][0]              \n","__________________________________________________________________________________________________\n","batch_normalization_29 (BatchNo (None, 112, 112, 32) 128         conv2d_transpose_14[0][0]        \n","__________________________________________________________________________________________________\n","activation_31 (Activation)      (None, 112, 112, 32) 0           batch_normalization_29[0][0]     \n","__________________________________________________________________________________________________\n","conv2d_transpose_15 (Conv2DTran (None, 112, 112, 32) 9248        activation_31[0][0]              \n","__________________________________________________________________________________________________\n","batch_normalization_30 (BatchNo (None, 112, 112, 32) 128         conv2d_transpose_15[0][0]        \n","__________________________________________________________________________________________________\n","up_sampling2d_15 (UpSampling2D) (None, 224, 224, 64) 0           add_12[0][0]                     \n","__________________________________________________________________________________________________\n","up_sampling2d_14 (UpSampling2D) (None, 224, 224, 32) 0           batch_normalization_30[0][0]     \n","__________________________________________________________________________________________________\n","conv2d_18 (Conv2D)              (None, 224, 224, 32) 2080        up_sampling2d_15[0][0]           \n","__________________________________________________________________________________________________\n","add_13 (Add)                    (None, 224, 224, 32) 0           up_sampling2d_14[0][0]           \n","                                                                 conv2d_18[0][0]                  \n","__________________________________________________________________________________________________\n","conv2d_19 (Conv2D)              (None, 224, 224, 3)  867         add_13[0][0]                     \n","==================================================================================================\n","Total params: 2,058,979\n","Trainable params: 2,055,203\n","Non-trainable params: 3,776\n","__________________________________________________________________________________________________\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"lfZGeJlWmOsn"},"source":["model.compile(optimizer =tf.keras.optimizers.Adam(),\n","              loss =tf.keras.losses.mse,\n","              metrics = ['mae'])"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"PAtZsGkbuzv6"},"source":["train_dataset = train_dataset.batch(32)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"gpp0PiCYq3hD","executionInfo":{"status":"ok","timestamp":1627151076151,"user_tz":-330,"elapsed":78422,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}},"outputId":"6767a5ab-3ca6-44a5-afce-379437ef40bb"},"source":["tf.config.run_functions_eagerly(True)\n","\n","model.fit(train_dataset,epochs = 2)"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Epoch 1/2\n","157/157 [==============================] - 39s 248ms/step - loss: 25006.6855 - mae: 102.6275\n","Epoch 2/2\n","157/157 [==============================] - 39s 248ms/step - loss: 25006.6855 - mae: 102.6275\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["<tensorflow.python.keras.callbacks.History at 0x7f7bf4eaa850>"]},"metadata":{"tags":[]},"execution_count":137}]},{"cell_type":"code","metadata":{"id":"v4zsTyk6whUU"},"source":["image = []\n","for x , y in train_dataset.take(1):\n","  image = x \n","  break"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"FtHW0sOVwul4"},"source":["image = image[0].numpy()"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"OfwUgdABwarl","executionInfo":{"status":"error","timestamp":1627151270541,"user_tz":-330,"elapsed":1510,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}},"outputId":"6e289645-206a-407b-aaaa-37a3aaa5a654"},"source":["prediction = model.predict(image)"],"execution_count":null,"outputs":[{"output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/tensorflow/python/data/ops/dataset_ops.py:3704: UserWarning: Even though the `tf.config.experimental_run_functions_eagerly` option is set, this option does not apply to tf.data functions. To force eager execution of tf.data functions, please use `tf.data.experimental.enable.debug_mode()`.\n","  \"Even though the `tf.config.experimental_run_functions_eagerly` \"\n"],"name":"stderr"},{"output_type":"display_data","data":{"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #ff0000; text-decoration-color: #ff0000\">╭──────────────────────────── </span><span style=\"color: #800000; text-decoration-color: #800000; font-weight: bold\">Traceback </span><span style=\"color: #bf7f7f; text-decoration-color: #bf7f7f; font-weight: bold\">(most recent call last)</span><span style=\"color: #ff0000; text-decoration-color: #ff0000\"> ────────────────────────────╮</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/IPython/core/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">interactiveshell.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">2882</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">run_code</span>  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2879 │   │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">try</span>:                                                                   <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2880 │   │   │   │   </span><span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>.hooks.pre_run_code_hook()                                     <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2881 │   │   │   │   #rprint('Running code', repr(code_obj)) # dbg</span>                      <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>2882 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   │   │   </span>exec(code_obj, <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>.user_global_ns, <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>.user_ns)                  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2883 │   │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">finally</span>:                                                               <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2884 │   │   │   │   # Reset our crash handler in place</span>                                 <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2885 │   │   │   │   </span>sys.excepthook = old_excepthook                                    <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #808000; text-decoration-color: #808000\">&lt;ipython-input-154-43a1bf812e10&gt;</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">1</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">&lt;module&gt;</span>                                            <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">training.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">1727</span> in <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">predict</span>                                                                                   <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1724 │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">with</span> data_handler.catch_stop_iteration():                                  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1725 │   │     </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">for</span> step <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">in</span> data_handler.steps():                                        <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1726 │   │   │   </span>callbacks.on_predict_batch_begin(step)                                 <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>1727 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   │   </span>tmp_batch_outputs = <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>.predict_function(iterator)                    <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1728 │   │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">if</span> data_handler.should_sync:                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1729 │   │   │     </span>context.async_wait()                                                 <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1730 │   │   │   </span>batch_outputs = tmp_batch_outputs  <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"># No error, now safe to assign.</span>     <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">training.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">1569</span> in <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">predict_function</span>                                                                          <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1566 │     </span>                                                                             <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1567 │     </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">def</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">predict_function</span>(iterator):                                              <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1568 │   │   </span><span style=\"color: #808000; text-decoration-color: #808000\">\"\"\"Runs an evaluation execution with one step.\"\"\"</span>                          <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>1569 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">return</span> step_function(<span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>, iterator)                                       <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1570 │   </span>                                                                               <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1571 │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">else</span>:                                                                          <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1572 </span>                                                                                   <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">training.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">1559</span> in <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">step_function</span>                                                                             <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1556 │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">return</span> outputs                                                             <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1557 │     </span>                                                                             <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1558 │     </span>data = <span style=\"color: #00ffff; text-decoration-color: #00ffff\">next</span>(iterator)                                                        <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>1559 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│     </span>outputs = model.distribute_strategy.run(run_step, args=(data,))              <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1560 │     </span>outputs = reduce_per_replica(                                                <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1561 │   │     </span>outputs, <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>.distribute_strategy, reduction=<span style=\"color: #808000; text-decoration-color: #808000\">'concat'</span>)                   <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1562 │     </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">return</span> outputs                                                               <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">distribute_lib.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">128</span> <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff\">5</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">run</span>                                                                                  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1282 │     # applied when the caller is also in Eager mode.</span>                             <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1283 │     </span>fn = autograph.tf_convert(                                                   <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1284 │   │     </span>fn, autograph_ctx.control_status_ctx(), convert_by_default=<span style=\"color: #0000ff; text-decoration-color: #0000ff\">False</span>)        <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>1285 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│     </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">return</span> <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>._extended.call_for_each_replica(fn, args=args, kwargs=kwargs)    <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1286   </span>                                                                                 <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1287   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">def</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">reduce</span>(<span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>, reduce_op, value, axis):                                        <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1288 │   </span><span style=\"color: #808000; text-decoration-color: #808000\">\"\"\"Reduce `value` across replicas and return result on current device.</span>         <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">distribute_lib.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">283</span> <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff\">3</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">call_for_each_replica</span>                                                                <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2830 │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">if</span> kwargs <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">is</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff\">None</span>:                                                             <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2831 │     </span>kwargs = {}                                                                  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2832 │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">with</span> <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>._container_strategy().scope():                                       <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>2833 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│     </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">return</span> <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>._call_for_each_replica(fn, args, kwargs)                         <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2834   </span>                                                                                 <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2835   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">def</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">_call_for_each_replica</span>(<span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>, fn, args, kwargs):                              <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2836 │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">raise</span> <span style=\"color: #00ffff; text-decoration-color: #00ffff\">NotImplementedError</span>(<span style=\"color: #808000; text-decoration-color: #808000\">\"must be implemented in descendants\"</span>)                <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">distribute_lib.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">360</span> <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff\">8</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">_call_for_each_replica</span>                                                               <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">3605   </span>                                                                                 <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">3606   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">def</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">_call_for_each_replica</span>(<span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>, fn, args, kwargs):                              <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">3607 │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">with</span> ReplicaContext(<span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>._container_strategy(), replica_id_in_sync_group=<span style=\"color: #0000ff; text-decoration-color: #0000ff\">0</span>):   <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>3608 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│     </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">return</span> fn(*args, **kwargs)                                                   <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">3609   </span>                                                                                 <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">3610   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">def</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">_reduce_to</span>(<span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>, reduce_op, value, destinations, options):                   <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">3611 │   # TODO(josh11b): Use destinations?</span>                                             <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/tensorflow/python/autograph/impl/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">api.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">597</span> in     <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">wrapper</span>                                                                                   <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">594   </span>                                                                                  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">595   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">def</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">wrapper</span>(*args, **kwargs):                                                     <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">596 │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">with</span> ag_ctx.ControlStatusCtx(status=ag_ctx.Status.UNSPECIFIED):                 <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>597 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│     </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">return</span> func(*args, **kwargs)                                                  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">598   </span>                                                                                  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">599   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">if</span> inspect.isfunction(func) <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">or</span> inspect.ismethod(func):                            <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">600 │   </span>wrapper = functools.update_wrapper(wrapper, func)                               <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">training.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">1552</span> in <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">run_step</span>                                                                                  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1549 │     </span><span style=\"color: #808000; text-decoration-color: #808000\">\"\"\"Runs a single evaluation step.\"\"\"</span>                                         <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1550 │     </span>                                                                             <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1551 │     </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">def</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">run_step</span>(data):                                                          <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>1552 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>outputs = model.predict_step(data)                                         <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1553 │   │   # Ensure counter is updated only if `test_step` succeeds.</span>                  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1554 │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">with</span> ops.control_dependencies(_minimum_control_deps(outputs)):             <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1555 │   │     </span>model._predict_counter.assign_add(<span style=\"color: #0000ff; text-decoration-color: #0000ff\">1</span>)  <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"># pylint: disable=protected-access</span> <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">training.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">1525</span> in <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">predict_step</span>                                                                              <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1522 </span><span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">│   </span><span style=\"color: #808000; text-decoration-color: #808000\">\"\"\"</span>                                                                            <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1523 │   </span>data = data_adapter.expand_1d(data)                                            <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1524 │   </span>x, _, _ = data_adapter.unpack_x_y_sample_weight(data)                          <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>1525 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">return</span> <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>(x, training=<span style=\"color: #0000ff; text-decoration-color: #0000ff\">False</span>)                                                 <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1526   </span>                                                                                 <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1527   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">def</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">make_predict_function</span>(<span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>):                                                 <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1528 │   </span><span style=\"color: #808000; text-decoration-color: #808000\">\"\"\"Creates a function that executes one step of inference.</span>                     <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">base_layer.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">1013</span>  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">__call__</span>                                                                               <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1010 │   │   </span>build_graph=<span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">not</span> eager,                                                     <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1011 │   │   </span>training=training_mode):                                                   <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1012 │     </span>                                                                             <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>1013 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│     </span>input_spec.assert_input_compatibility(<span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>.input_spec, inputs, <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>.name)    <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1014 │     </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">if</span> eager:                                                                    <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1015 │   │   </span>call_fn = <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>.call                                                        <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1016 │   │   </span>name_scope = <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>._name                                                    <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">input_spec.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">270</span>   <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">assert_input_compatibility</span>                                                             <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">267 │   │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">raise</span> <span style=\"color: #00ffff; text-decoration-color: #00ffff\">ValueError</span>(<span style=\"color: #808000; text-decoration-color: #808000\">'Input '</span> + <span style=\"color: #00ffff; text-decoration-color: #00ffff\">str</span>(input_index) +                          <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">268 │   │   │   │   │   │   │    </span><span style=\"color: #808000; text-decoration-color: #808000\">' is incompatible with layer '</span> + layer_name +          <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">269 │   │   │   │   │   │   │    </span><span style=\"color: #808000; text-decoration-color: #808000\">': expected shape='</span> + <span style=\"color: #00ffff; text-decoration-color: #00ffff\">str</span>(spec.shape) +                <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>270 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   │   │   │   │   │    </span><span style=\"color: #808000; text-decoration-color: #808000\">', found shape='</span> + display_shape(x.shape))             <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">271 </span>                                                                                    <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">272 </span>                                                                                    <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">273 </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">def</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">display_shape</span>(shape):                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">╰───────────────────────────────────────────────────────────────────────────────────────────╯</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000; font-weight: bold\">ValueError: </span>Input <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> is incompatible with layer model_2: expected <span style=\"color: #808000; text-decoration-color: #808000\">shape</span>=<span style=\"font-weight: bold\">(</span><span style=\"color: #800080; text-decoration-color: #800080; font-style: italic\">None</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">224</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">224</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span><span style=\"font-weight: bold\">)</span>, \n","found <span style=\"color: #808000; text-decoration-color: #808000\">shape</span>=<span style=\"font-weight: bold\">(</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">224</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span><span style=\"font-weight: bold\">)</span>\n","</pre>\n"],"text/plain":["\u001b[91m╭─\u001b[0m\u001b[91m─────────────────────────── \u001b[0m\u001b[1;31mTraceback \u001b[0m\u001b[1;2;31m(most recent call last)\u001b[0m\u001b[91m ───────────────────────────\u001b[0m\u001b[91m─╮\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/IPython/core/\u001b[0m\u001b[1;33minteractiveshell.py\u001b[0m:\u001b[94m2882\u001b[0m in \u001b[92mrun_code\u001b[0m  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2879 \u001b[0m\u001b[2m│   │   │   \u001b[0m\u001b[94mtry\u001b[0m:                                                                   \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2880 \u001b[0m\u001b[2m│   │   │   │   \u001b[0m\u001b[96mself\u001b[0m.hooks.pre_run_code_hook()                                     \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2881 \u001b[0m\u001b[2m│   │   │   │   \u001b[0m\u001b[2m#rprint('Running code', repr(code_obj)) # dbg\u001b[0m                      \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m2882 \u001b[2m│   │   │   │   \u001b[0mexec(code_obj, \u001b[96mself\u001b[0m.user_global_ns, \u001b[96mself\u001b[0m.user_ns)                  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2883 \u001b[0m\u001b[2m│   │   │   \u001b[0m\u001b[94mfinally\u001b[0m:                                                               \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2884 \u001b[0m\u001b[2m│   │   │   │   \u001b[0m\u001b[2m# Reset our crash handler in place\u001b[0m                                 \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2885 \u001b[0m\u001b[2m│   │   │   │   \u001b[0msys.excepthook = old_excepthook                                    \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[33m<ipython-input-154-43a1bf812e10>\u001b[0m:\u001b[94m1\u001b[0m in \u001b[92m<module>\u001b[0m                                            \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/\u001b[0m\u001b[1;33mtraining.py\u001b[0m:\u001b[94m1727\u001b[0m in \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[92mpredict\u001b[0m                                                                                   \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1724 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[94mwith\u001b[0m data_handler.catch_stop_iteration():                                  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1725 \u001b[0m\u001b[2m│   │     \u001b[0m\u001b[94mfor\u001b[0m step \u001b[95min\u001b[0m data_handler.steps():                                        \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1726 \u001b[0m\u001b[2m│   │   │   \u001b[0mcallbacks.on_predict_batch_begin(step)                                 \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m1727 \u001b[2m│   │   │   \u001b[0mtmp_batch_outputs = \u001b[96mself\u001b[0m.predict_function(iterator)                    \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1728 \u001b[0m\u001b[2m│   │   │   \u001b[0m\u001b[94mif\u001b[0m data_handler.should_sync:                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1729 \u001b[0m\u001b[2m│   │   │     \u001b[0mcontext.async_wait()                                                 \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1730 \u001b[0m\u001b[2m│   │   │   \u001b[0mbatch_outputs = tmp_batch_outputs  \u001b[2m# No error, now safe to assign.\u001b[0m     \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/\u001b[0m\u001b[1;33mtraining.py\u001b[0m:\u001b[94m1569\u001b[0m in \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[92mpredict_function\u001b[0m                                                                          \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1566 \u001b[0m\u001b[2m│     \u001b[0m                                                                             \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1567 \u001b[0m\u001b[2m│     \u001b[0m\u001b[94mdef\u001b[0m \u001b[92mpredict_function\u001b[0m(iterator):                                              \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1568 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[33m\"\"\"Runs an evaluation execution with one step.\"\"\"\u001b[0m                          \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m1569 \u001b[2m│   │   \u001b[0m\u001b[94mreturn\u001b[0m step_function(\u001b[96mself\u001b[0m, iterator)                                       \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1570 \u001b[0m\u001b[2m│   \u001b[0m                                                                               \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1571 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94melse\u001b[0m:                                                                          \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1572 \u001b[0m                                                                                   \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/\u001b[0m\u001b[1;33mtraining.py\u001b[0m:\u001b[94m1559\u001b[0m in \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[92mstep_function\u001b[0m                                                                             \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1556 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[94mreturn\u001b[0m outputs                                                             \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1557 \u001b[0m\u001b[2m│     \u001b[0m                                                                             \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1558 \u001b[0m\u001b[2m│     \u001b[0mdata = \u001b[96mnext\u001b[0m(iterator)                                                        \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m1559 \u001b[2m│     \u001b[0moutputs = model.distribute_strategy.run(run_step, args=(data,))              \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1560 \u001b[0m\u001b[2m│     \u001b[0moutputs = reduce_per_replica(                                                \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1561 \u001b[0m\u001b[2m│   │     \u001b[0moutputs, \u001b[96mself\u001b[0m.distribute_strategy, reduction=\u001b[33m'\u001b[0m\u001b[33mconcat\u001b[0m\u001b[33m'\u001b[0m)                   \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1562 \u001b[0m\u001b[2m│     \u001b[0m\u001b[94mreturn\u001b[0m outputs                                                               \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/\u001b[0m\u001b[1;33mdistribute_lib.py\u001b[0m:\u001b[94m128\u001b[0m \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[94m5\u001b[0m in \u001b[92mrun\u001b[0m                                                                                  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1282 \u001b[0m\u001b[2m│     \u001b[0m\u001b[2m# applied when the caller is also in Eager mode.\u001b[0m                             \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1283 \u001b[0m\u001b[2m│     \u001b[0mfn = autograph.tf_convert(                                                   \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1284 \u001b[0m\u001b[2m│   │     \u001b[0mfn, autograph_ctx.control_status_ctx(), convert_by_default=\u001b[94mFalse\u001b[0m)        \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m1285 \u001b[2m│     \u001b[0m\u001b[94mreturn\u001b[0m \u001b[96mself\u001b[0m._extended.call_for_each_replica(fn, args=args, kwargs=kwargs)    \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1286 \u001b[0m\u001b[2m  \u001b[0m                                                                                 \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1287 \u001b[0m\u001b[2m  \u001b[0m\u001b[94mdef\u001b[0m \u001b[92mreduce\u001b[0m(\u001b[96mself\u001b[0m, reduce_op, value, axis):                                        \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1288 \u001b[0m\u001b[2m│   \u001b[0m\u001b[33m\"\"\"Reduce `value` across replicas and return result on current device.\u001b[0m         \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/\u001b[0m\u001b[1;33mdistribute_lib.py\u001b[0m:\u001b[94m283\u001b[0m \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[94m3\u001b[0m in \u001b[92mcall_for_each_replica\u001b[0m                                                                \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2830 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94mif\u001b[0m kwargs \u001b[95mis\u001b[0m \u001b[94mNone\u001b[0m:                                                             \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2831 \u001b[0m\u001b[2m│     \u001b[0mkwargs = {}                                                                  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2832 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94mwith\u001b[0m \u001b[96mself\u001b[0m._container_strategy().scope():                                       \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m2833 \u001b[2m│     \u001b[0m\u001b[94mreturn\u001b[0m \u001b[96mself\u001b[0m._call_for_each_replica(fn, args, kwargs)                         \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2834 \u001b[0m\u001b[2m  \u001b[0m                                                                                 \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2835 \u001b[0m\u001b[2m  \u001b[0m\u001b[94mdef\u001b[0m \u001b[92m_call_for_each_replica\u001b[0m(\u001b[96mself\u001b[0m, fn, args, kwargs):                              \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2836 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94mraise\u001b[0m \u001b[96mNotImplementedError\u001b[0m(\u001b[33m\"\u001b[0m\u001b[33mmust be implemented in descendants\u001b[0m\u001b[33m\"\u001b[0m)                \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/\u001b[0m\u001b[1;33mdistribute_lib.py\u001b[0m:\u001b[94m360\u001b[0m \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[94m8\u001b[0m in \u001b[92m_call_for_each_replica\u001b[0m                                                               \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m3605 \u001b[0m\u001b[2m  \u001b[0m                                                                                 \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m3606 \u001b[0m\u001b[2m  \u001b[0m\u001b[94mdef\u001b[0m \u001b[92m_call_for_each_replica\u001b[0m(\u001b[96mself\u001b[0m, fn, args, kwargs):                              \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m3607 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94mwith\u001b[0m ReplicaContext(\u001b[96mself\u001b[0m._container_strategy(), replica_id_in_sync_group=\u001b[94m0\u001b[0m):   \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m3608 \u001b[2m│     \u001b[0m\u001b[94mreturn\u001b[0m fn(*args, **kwargs)                                                   \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m3609 \u001b[0m\u001b[2m  \u001b[0m                                                                                 \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m3610 \u001b[0m\u001b[2m  \u001b[0m\u001b[94mdef\u001b[0m \u001b[92m_reduce_to\u001b[0m(\u001b[96mself\u001b[0m, reduce_op, value, destinations, options):                   \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m3611 \u001b[0m\u001b[2m│   \u001b[0m\u001b[2m# TODO(josh11b): Use destinations?\u001b[0m                                             \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/tensorflow/python/autograph/impl/\u001b[0m\u001b[1;33mapi.py\u001b[0m:\u001b[94m597\u001b[0m in     \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[92mwrapper\u001b[0m                                                                                   \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m594 \u001b[0m\u001b[2m  \u001b[0m                                                                                  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m595 \u001b[0m\u001b[2m  \u001b[0m\u001b[94mdef\u001b[0m \u001b[92mwrapper\u001b[0m(*args, **kwargs):                                                     \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m596 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94mwith\u001b[0m ag_ctx.ControlStatusCtx(status=ag_ctx.Status.UNSPECIFIED):                 \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m597 \u001b[2m│     \u001b[0m\u001b[94mreturn\u001b[0m func(*args, **kwargs)                                                  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m598 \u001b[0m\u001b[2m  \u001b[0m                                                                                  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m599 \u001b[0m\u001b[2m  \u001b[0m\u001b[94mif\u001b[0m inspect.isfunction(func) \u001b[95mor\u001b[0m inspect.ismethod(func):                            \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m600 \u001b[0m\u001b[2m│   \u001b[0mwrapper = functools.update_wrapper(wrapper, func)                               \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/\u001b[0m\u001b[1;33mtraining.py\u001b[0m:\u001b[94m1552\u001b[0m in \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[92mrun_step\u001b[0m                                                                                  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1549 \u001b[0m\u001b[2m│     \u001b[0m\u001b[33m\"\"\"Runs a single evaluation step.\"\"\"\u001b[0m                                         \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1550 \u001b[0m\u001b[2m│     \u001b[0m                                                                             \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1551 \u001b[0m\u001b[2m│     \u001b[0m\u001b[94mdef\u001b[0m \u001b[92mrun_step\u001b[0m(data):                                                          \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m1552 \u001b[2m│   │   \u001b[0moutputs = model.predict_step(data)                                         \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1553 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[2m# Ensure counter is updated only if `test_step` succeeds.\u001b[0m                  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1554 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[94mwith\u001b[0m ops.control_dependencies(_minimum_control_deps(outputs)):             \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1555 \u001b[0m\u001b[2m│   │     \u001b[0mmodel._predict_counter.assign_add(\u001b[94m1\u001b[0m)  \u001b[2m# pylint: disable=protected-access\u001b[0m \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/\u001b[0m\u001b[1;33mtraining.py\u001b[0m:\u001b[94m1525\u001b[0m in \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[92mpredict_step\u001b[0m                                                                              \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1522 \u001b[0m\u001b[2;33m│   \u001b[0m\u001b[33m\"\"\"\u001b[0m                                                                            \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1523 \u001b[0m\u001b[2m│   \u001b[0mdata = data_adapter.expand_1d(data)                                            \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1524 \u001b[0m\u001b[2m│   \u001b[0mx, _, _ = data_adapter.unpack_x_y_sample_weight(data)                          \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m1525 \u001b[2m│   \u001b[0m\u001b[94mreturn\u001b[0m \u001b[96mself\u001b[0m(x, training=\u001b[94mFalse\u001b[0m)                                                 \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1526 \u001b[0m\u001b[2m  \u001b[0m                                                                                 \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1527 \u001b[0m\u001b[2m  \u001b[0m\u001b[94mdef\u001b[0m \u001b[92mmake_predict_function\u001b[0m(\u001b[96mself\u001b[0m):                                                 \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1528 \u001b[0m\u001b[2m│   \u001b[0m\u001b[33m\"\"\"Creates a function that executes one step of inference.\u001b[0m                     \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/\u001b[0m\u001b[1;33mbase_layer.py\u001b[0m:\u001b[94m1013\u001b[0m  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m in \u001b[92m__call__\u001b[0m                                                                               \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1010 \u001b[0m\u001b[2m│   │   \u001b[0mbuild_graph=\u001b[95mnot\u001b[0m eager,                                                     \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1011 \u001b[0m\u001b[2m│   │   \u001b[0mtraining=training_mode):                                                   \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1012 \u001b[0m\u001b[2m│     \u001b[0m                                                                             \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m1013 \u001b[2m│     \u001b[0minput_spec.assert_input_compatibility(\u001b[96mself\u001b[0m.input_spec, inputs, \u001b[96mself\u001b[0m.name)    \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1014 \u001b[0m\u001b[2m│     \u001b[0m\u001b[94mif\u001b[0m eager:                                                                    \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1015 \u001b[0m\u001b[2m│   │   \u001b[0mcall_fn = \u001b[96mself\u001b[0m.call                                                        \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1016 \u001b[0m\u001b[2m│   │   \u001b[0mname_scope = \u001b[96mself\u001b[0m._name                                                    \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/\u001b[0m\u001b[1;33minput_spec.py\u001b[0m:\u001b[94m270\u001b[0m   \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m in \u001b[92massert_input_compatibility\u001b[0m                                                             \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m267 \u001b[0m\u001b[2m│   │   │   \u001b[0m\u001b[94mraise\u001b[0m \u001b[96mValueError\u001b[0m(\u001b[33m'\u001b[0m\u001b[33mInput \u001b[0m\u001b[33m'\u001b[0m + \u001b[96mstr\u001b[0m(input_index) +                          \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m268 \u001b[0m\u001b[2m│   │   │   │   │   │   │    \u001b[0m\u001b[33m'\u001b[0m\u001b[33m is incompatible with layer \u001b[0m\u001b[33m'\u001b[0m + layer_name +          \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m269 \u001b[0m\u001b[2m│   │   │   │   │   │   │    \u001b[0m\u001b[33m'\u001b[0m\u001b[33m: expected shape=\u001b[0m\u001b[33m'\u001b[0m + \u001b[96mstr\u001b[0m(spec.shape) +                \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m270 \u001b[2m│   │   │   │   │   │   │    \u001b[0m\u001b[33m'\u001b[0m\u001b[33m, found shape=\u001b[0m\u001b[33m'\u001b[0m + display_shape(x.shape))             \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m271 \u001b[0m                                                                                    \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m272 \u001b[0m                                                                                    \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m273 \u001b[0m\u001b[94mdef\u001b[0m \u001b[92mdisplay_shape\u001b[0m(shape):                                                           \u001b[91m│\u001b[0m\n","\u001b[91m╰───────────────────────────────────────────────────────────────────────────────────────────╯\u001b[0m\n","\u001b[1;91mValueError: \u001b[0mInput \u001b[1;36m0\u001b[0m is incompatible with layer model_2: expected \u001b[33mshape\u001b[0m=\u001b[1m(\u001b[0m\u001b[3;35mNone\u001b[0m, \u001b[1;36m224\u001b[0m, \u001b[1;36m224\u001b[0m, \u001b[1;36m3\u001b[0m\u001b[1m)\u001b[0m, \n","found \u001b[33mshape\u001b[0m=\u001b[1m(\u001b[0m\u001b[1;36m32\u001b[0m, \u001b[1;36m224\u001b[0m, \u001b[1;36m3\u001b[0m\u001b[1m)\u001b[0m\n"]},"metadata":{"tags":[]}}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"VZdJlOQpwxWW","executionInfo":{"status":"ok","timestamp":1627151153338,"user_tz":-330,"elapsed":493,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}},"outputId":"799014ac-528d-4787-88d5-344ea322ef8f"},"source":["prediction"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[[[0.30375713, 0.34754395, 0.34869897],\n","         [0.32175106, 0.32944313, 0.34880581],\n","         [0.32557696, 0.33533803, 0.33908498],\n","         ...,\n","         [0.33932346, 0.3391382 , 0.32153836],\n","         [0.3315321 , 0.3404825 , 0.32798544],\n","         [0.33448702, 0.3519065 , 0.31360644]],\n","\n","        [[0.3413139 , 0.3158127 , 0.34287342],\n","         [0.33833563, 0.31782532, 0.3438391 ],\n","         [0.34270015, 0.32260293, 0.33469692],\n","         ...,\n","         [0.33327505, 0.3393066 , 0.32741833],\n","         [0.32599893, 0.33961523, 0.33438587],\n","         [0.3261971 , 0.34136507, 0.33243787]],\n","\n","        [[0.34510434, 0.31820863, 0.336687  ],\n","         [0.33248764, 0.32684857, 0.34066376],\n","         [0.33353478, 0.3291381 , 0.33732712],\n","         ...,\n","         [0.33254057, 0.3338378 , 0.33362162],\n","         [0.3267129 , 0.33567527, 0.3376118 ],\n","         [0.32519943, 0.33752346, 0.33727708]],\n","\n","        ...,\n","\n","        [[0.33602402, 0.31721053, 0.34676543],\n","         [0.3328982 , 0.33486626, 0.33223557],\n","         [0.32831106, 0.33300668, 0.33868226],\n","         ...,\n","         [0.32806143, 0.33099124, 0.3409473 ],\n","         [0.3333738 , 0.32983723, 0.33678892],\n","         [0.32149422, 0.33175588, 0.3467499 ]],\n","\n","        [[0.33916685, 0.3188673 , 0.34196582],\n","         [0.33537433, 0.33682117, 0.3278045 ],\n","         [0.3291825 , 0.33412555, 0.33669192],\n","         ...,\n","         [0.32682335, 0.3300122 , 0.34316447],\n","         [0.33329108, 0.33152038, 0.33518854],\n","         [0.32013863, 0.33229378, 0.3475676 ]],\n","\n","        [[0.3281608 , 0.33786488, 0.33397427],\n","         [0.32498235, 0.34807438, 0.32694328],\n","         [0.32445928, 0.34138724, 0.33415353],\n","         ...,\n","         [0.34331346, 0.32407334, 0.33261323],\n","         [0.352226  , 0.3290352 , 0.3187388 ],\n","         [0.34301886, 0.3271535 , 0.32982767]]],\n","\n","\n","       [[[0.32047978, 0.33082455, 0.34869567],\n","         [0.3265331 , 0.32356137, 0.34990555],\n","         [0.32975098, 0.32913795, 0.34111103],\n","         ...,\n","         [0.3322201 , 0.34106278, 0.32671705],\n","         [0.32526103, 0.34151387, 0.33322507],\n","         [0.33236042, 0.34273636, 0.3249032 ]],\n","\n","        [[0.3310619 , 0.31808573, 0.35085234],\n","         [0.33548155, 0.32171762, 0.34280083],\n","         [0.33875605, 0.32779458, 0.3334493 ],\n","         ...,\n","         [0.33040515, 0.3354944 , 0.3341004 ],\n","         [0.32402974, 0.33456331, 0.34140697],\n","         [0.3260877 , 0.3407115 , 0.33320078]],\n","\n","        [[0.335413  , 0.32086372, 0.34372327],\n","         [0.32999435, 0.3304561 , 0.33954954],\n","         [0.32969192, 0.33362094, 0.33668712],\n","         ...,\n","         [0.3302631 , 0.3316903 , 0.33804652],\n","         [0.32606173, 0.33213264, 0.34180564],\n","         [0.3268045 , 0.3375614 , 0.33563414]],\n","\n","        ...,\n","\n","        [[0.3405831 , 0.32129818, 0.33811876],\n","         [0.33232984, 0.33597285, 0.3316973 ],\n","         [0.32787958, 0.33444113, 0.3376793 ],\n","         ...,\n","         [0.32593742, 0.33169746, 0.34236512],\n","         [0.33272696, 0.3311035 , 0.33616957],\n","         [0.32649565, 0.33257362, 0.3409307 ]],\n","\n","        [[0.34375414, 0.32288283, 0.33336306],\n","         [0.3357034 , 0.33641064, 0.32788593],\n","         [0.32912788, 0.33333534, 0.3375368 ],\n","         ...,\n","         [0.32402694, 0.33047095, 0.34550214],\n","         [0.33240446, 0.33273122, 0.33486432],\n","         [0.3241318 , 0.33333063, 0.34253755]],\n","\n","        [[0.31273493, 0.36482227, 0.32244277],\n","         [0.31781456, 0.35018063, 0.3320048 ],\n","         [0.3164945 , 0.34325475, 0.34025076],\n","         ...,\n","         [0.33862907, 0.321412  , 0.33995894],\n","         [0.35033175, 0.32647127, 0.32319698],\n","         [0.3581072 , 0.3020699 , 0.33982286]]],\n","\n","\n","       [[[0.31154034, 0.35055965, 0.3379    ],\n","         [0.3254484 , 0.3233868 , 0.35116485],\n","         [0.32937908, 0.32929605, 0.3413249 ],\n","         ...,\n","         [0.3343462 , 0.33907488, 0.32657894],\n","         [0.32666138, 0.3403342 , 0.33300436],\n","         [0.33122167, 0.34284538, 0.32593292]],\n","\n","        [[0.3393614 , 0.3213928 , 0.33924583],\n","         [0.3353015 , 0.3180451 , 0.34665343],\n","         [0.3397884 , 0.32404184, 0.33616972],\n","         ...,\n","         [0.33306256, 0.33994818, 0.32698923],\n","         [0.32638827, 0.3397392 , 0.3338725 ],\n","         [0.33507308, 0.3385562 , 0.3263707 ]],\n","\n","        [[0.34329543, 0.32464805, 0.33205655],\n","         [0.33010393, 0.32710826, 0.34278777],\n","         [0.33087787, 0.33040345, 0.33871865],\n","         ...,\n","         [0.33296248, 0.33427402, 0.33276355],\n","         [0.3275546 , 0.33547682, 0.3369686 ],\n","         [0.3348588 , 0.33412102, 0.33102018]],\n","\n","        ...,\n","\n","        [[0.32597795, 0.326246  , 0.34777606],\n","         [0.33132958, 0.3380517 , 0.33061865],\n","         [0.32811695, 0.3354532 , 0.3364298 ],\n","         ...,\n","         [0.32888317, 0.3301756 , 0.34094125],\n","         [0.33558002, 0.33064625, 0.33377376],\n","         [0.33074433, 0.33006254, 0.33919317]],\n","\n","        [[0.329622  , 0.32865524, 0.3417228 ],\n","         [0.3347671 , 0.3388376 , 0.32639536],\n","         [0.32981566, 0.3353266 , 0.33485776],\n","         ...,\n","         [0.32694328, 0.33126077, 0.34179595],\n","         [0.3333281 , 0.33376953, 0.33290234],\n","         [0.3289151 , 0.33180404, 0.33928087]],\n","\n","        [[0.3182199 , 0.33544913, 0.34633097],\n","         [0.32918322, 0.35256615, 0.31825066],\n","         [0.3286714 , 0.34552228, 0.3258063 ],\n","         ...,\n","         [0.34830204, 0.3188858 , 0.33281213],\n","         [0.35831076, 0.32424203, 0.3174472 ],\n","         [0.34465513, 0.32974637, 0.32559848]]],\n","\n","\n","       ...,\n","\n","\n","       [[[0.3295174 , 0.3537706 , 0.31671196],\n","         [0.33239752, 0.32089743, 0.34670505],\n","         [0.3355832 , 0.32757375, 0.336843  ],\n","         ...,\n","         [0.3341112 , 0.34246403, 0.32342476],\n","         [0.32715523, 0.34412047, 0.3287243 ],\n","         [0.3266489 , 0.34650856, 0.3268425 ]],\n","\n","        [[0.34089345, 0.32398167, 0.33512485],\n","         [0.3376871 , 0.32200322, 0.3403097 ],\n","         [0.33939573, 0.32869214, 0.33191213],\n","         ...,\n","         [0.33163553, 0.33908594, 0.3292785 ],\n","         [0.32576805, 0.33958277, 0.33464915],\n","         [0.3272432 , 0.33836594, 0.33439088]],\n","\n","        [[0.34407735, 0.32721135, 0.32871127],\n","         [0.331019  , 0.33152896, 0.33745196],\n","         [0.32920387, 0.33595687, 0.33483925],\n","         ...,\n","         [0.3305405 , 0.33491942, 0.33454007],\n","         [0.3263798 , 0.33734417, 0.33627602],\n","         [0.326059  , 0.33578262, 0.3381584 ]],\n","\n","        ...,\n","\n","        [[0.3396868 , 0.32888064, 0.33143255],\n","         [0.33149067, 0.33727396, 0.3312354 ],\n","         [0.3290285 , 0.33758953, 0.33338198],\n","         ...,\n","         [0.33076602, 0.33432198, 0.334912  ],\n","         [0.33507532, 0.33497986, 0.32994482],\n","         [0.33136806, 0.32982233, 0.33880964]],\n","\n","        [[0.34313655, 0.32909375, 0.32776964],\n","         [0.33440432, 0.3360311 , 0.32956457],\n","         [0.329486  , 0.33530885, 0.3352052 ],\n","         ...,\n","         [0.3289536 , 0.33178794, 0.33925843],\n","         [0.3343518 , 0.3353604 , 0.33028772],\n","         [0.3279553 , 0.33001631, 0.3420284 ]],\n","\n","        [[0.2923205 , 0.3560664 , 0.35161313],\n","         [0.3216072 , 0.34454232, 0.33385044],\n","         [0.32335198, 0.3373483 , 0.3392997 ],\n","         ...,\n","         [0.33879066, 0.32493407, 0.33627528],\n","         [0.34906068, 0.3306274 , 0.320312  ],\n","         [0.3401351 , 0.33560944, 0.32425547]]],\n","\n","\n","       [[[0.32465494, 0.33088872, 0.34445632],\n","         [0.32870775, 0.32761493, 0.34367728],\n","         [0.33174866, 0.33192968, 0.33632165],\n","         ...,\n","         [0.33584198, 0.34069422, 0.32346377],\n","         [0.3288533 , 0.3422557 , 0.32889098],\n","         [0.34970212, 0.35174316, 0.2985547 ]],\n","\n","        [[0.33306813, 0.3163792 , 0.3505527 ],\n","         [0.33522984, 0.32195714, 0.34281304],\n","         [0.33869958, 0.32615834, 0.33514208],\n","         ...,\n","         [0.3297868 , 0.3372146 , 0.33299857],\n","         [0.32475638, 0.3359123 , 0.33933133],\n","         [0.32700923, 0.34117422, 0.33181652]],\n","\n","        [[0.33689645, 0.31846842, 0.3446351 ],\n","         [0.33051825, 0.3292003 , 0.3402815 ],\n","         [0.33070183, 0.33111212, 0.33818606],\n","         ...,\n","         [0.32843196, 0.33337876, 0.3381893 ],\n","         [0.32544583, 0.33369008, 0.3408641 ],\n","         [0.32597136, 0.33741423, 0.33661434]],\n","\n","        ...,\n","\n","        [[0.33187696, 0.3249851 , 0.34313795],\n","         [0.3313157 , 0.33777553, 0.33090875],\n","         [0.3293991 , 0.3346747 , 0.33592618],\n","         ...,\n","         [0.3313353 , 0.33261174, 0.33605292],\n","         [0.33438152, 0.33319098, 0.3324275 ],\n","         [0.3295349 , 0.32678986, 0.34367523]],\n","\n","        [[0.33399042, 0.3268958 , 0.3391138 ],\n","         [0.3332268 , 0.33869672, 0.32807645],\n","         [0.32986224, 0.3348429 , 0.33529487],\n","         ...,\n","         [0.32978195, 0.332555  , 0.33766305],\n","         [0.33389357, 0.33620355, 0.3299029 ],\n","         [0.32829168, 0.3288065 , 0.3429018 ]],\n","\n","        [[0.32712924, 0.35593835, 0.31693247],\n","         [0.32192844, 0.3480834 , 0.32998818],\n","         [0.32309085, 0.34036106, 0.33654812],\n","         ...,\n","         [0.34035367, 0.32320955, 0.33643675],\n","         [0.34886727, 0.32853597, 0.3225968 ],\n","         [0.3531664 , 0.3248253 , 0.3220083 ]]],\n","\n","\n","       [[[0.33125567, 0.31748042, 0.35126388],\n","         [0.3285383 , 0.32720035, 0.34426135],\n","         [0.33209497, 0.33213997, 0.33576506],\n","         ...,\n","         [0.333384  , 0.33938408, 0.32723185],\n","         [0.32685703, 0.34012693, 0.333016  ],\n","         [0.34601024, 0.3264033 , 0.32758644]],\n","\n","        [[0.32978946, 0.32265174, 0.3475588 ],\n","         [0.3362385 , 0.3219939 , 0.3417676 ],\n","         [0.33950597, 0.32755908, 0.33293492],\n","         ...,\n","         [0.3272883 , 0.33792797, 0.33478373],\n","         [0.3218232 , 0.33744082, 0.340736  ],\n","         [0.3252809 , 0.33331507, 0.34140402]],\n","\n","        [[0.3341027 , 0.32414812, 0.34174916],\n","         [0.33232722, 0.32924002, 0.3384328 ],\n","         [0.33249682, 0.33159667, 0.33590654],\n","         ...,\n","         [0.3272964 , 0.3340139 , 0.33868963],\n","         [0.32372832, 0.3347337 , 0.34153795],\n","         [0.32542467, 0.32975045, 0.3448249 ]],\n","\n","        ...,\n","\n","        [[0.34139106, 0.31759247, 0.3410165 ],\n","         [0.3302656 , 0.3331209 , 0.33661348],\n","         [0.32756308, 0.3318085 , 0.34062845],\n","         ...,\n","         [0.3237279 , 0.33355978, 0.3427123 ],\n","         [0.33026862, 0.3336082 , 0.33612314],\n","         [0.33179986, 0.3335046 , 0.33469552]],\n","\n","        [[0.34300476, 0.31879643, 0.33819887],\n","         [0.3321994 , 0.33506998, 0.33273056],\n","         [0.32770917, 0.3332234 , 0.3390675 ],\n","         ...,\n","         [0.32149246, 0.3331184 , 0.3453892 ],\n","         [0.3285708 , 0.33605364, 0.33537552],\n","         [0.32815075, 0.33517894, 0.3366703 ]],\n","\n","        [[0.335865  , 0.34967402, 0.31446108],\n","         [0.3304189 , 0.34748226, 0.32209882],\n","         [0.33053407, 0.34088647, 0.32857946],\n","         ...,\n","         [0.34853438, 0.3199345 , 0.3315311 ],\n","         [0.35885736, 0.32546586, 0.3156768 ],\n","         [0.34164897, 0.3089    , 0.349451  ]]]], dtype=float32)"]},"metadata":{"tags":[]},"execution_count":143}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"oLvY6GyGxDTd","executionInfo":{"status":"error","timestamp":1627151183916,"user_tz":-330,"elapsed":1447,"user":{"displayName":"Signalism Project","photoUrl":"","userId":"17236237126645032014"}},"outputId":"924be304-51e2-41e2-b3e0-bdb4a1635598"},"source":["plt.imshow(image)"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #ff0000; text-decoration-color: #ff0000\">╭──────────────────────────── </span><span style=\"color: #800000; text-decoration-color: #800000; font-weight: bold\">Traceback </span><span style=\"color: #bf7f7f; text-decoration-color: #bf7f7f; font-weight: bold\">(most recent call last)</span><span style=\"color: #ff0000; text-decoration-color: #ff0000\"> ────────────────────────────╮</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/IPython/core/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">interactiveshell.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">2882</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">run_code</span>  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2879 │   │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">try</span>:                                                                   <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2880 │   │   │   │   </span><span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>.hooks.pre_run_code_hook()                                     <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2881 │   │   │   │   #rprint('Running code', repr(code_obj)) # dbg</span>                      <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>2882 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   │   │   </span>exec(code_obj, <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>.user_global_ns, <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>.user_ns)                  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2883 │   │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">finally</span>:                                                               <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2884 │   │   │   │   # Reset our crash handler in place</span>                                 <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2885 │   │   │   │   </span>sys.excepthook = old_excepthook                                    <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #808000; text-decoration-color: #808000\">&lt;ipython-input-146-12ba6d47bd7e&gt;</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">1</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">&lt;module&gt;</span>                                            <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/matplotlib/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">pyplot.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">2651</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">imshow</span>                <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2648 │   │   </span>vmax=vmax, origin=origin, extent=extent, shape=shape,                      <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2649 │   │   </span>filternorm=filternorm, filterrad=filterrad, imlim=imlim,                   <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2650 │   │   </span>resample=resample, url=url, **({<span style=\"color: #808000; text-decoration-color: #808000\">\"data\"</span>: data} <span style=\"color: #0000ff; text-decoration-color: #0000ff\">if</span> data <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">is</span> <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">not</span>               <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>2651 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">None</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff\">else</span> {}), **kwargs)                                                   <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2652 │   </span>sci(__ret)                                                                     <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2653 │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">return</span> __ret                                                                   <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">2654 </span>                                                                                   <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/matplotlib/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">__init__.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">1565</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">inner</span>               <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1562 │   </span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold\">@functools</span>.wraps(func)                                                         <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1563 │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">def</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">inner</span>(ax, *args, data=<span style=\"color: #0000ff; text-decoration-color: #0000ff\">None</span>, **kwargs):                                     <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1564 │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">if</span> data <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">is</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff\">None</span>:                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>1565 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">return</span> func(ax, *<span style=\"color: #00ffff; text-decoration-color: #00ffff\">map</span>(sanitize_sequence, args), **kwargs)               <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1566 │   │   </span>                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1567 │   │   </span>bound = new_sig.bind(ax, *args, **kwargs)                                  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">1568 │   │   </span>auto_label = (bound.arguments.get(label_namer)                             <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/matplotlib/cbook/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">deprecation.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">358</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">wrapper</span>     <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">355 │   │   │   │   </span><span style=\"color: #808000; text-decoration-color: #808000\">f\"is deprecated since Matplotlib {</span>since<span style=\"color: #808000; text-decoration-color: #808000\">} and will be removed \"</span>      <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">356 │   │   │   │   </span><span style=\"color: #808000; text-decoration-color: #808000\">f\"%(removal)s.  If any parameter follows {</span>name<span style=\"color: #808000; text-decoration-color: #808000\">!r}, they \"</span>           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">357 │   │   │   │   </span><span style=\"color: #808000; text-decoration-color: #808000\">f\"should be pass as keyword, not positionally.\"</span>)                    <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>358 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">return</span> func(*args, **kwargs)                                                <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">359 │   </span>                                                                                <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">360 │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">return</span> wrapper                                                                  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">361 </span>                                                                                    <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/matplotlib/cbook/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">deprecation.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">358</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">wrapper</span>     <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">355 │   │   │   │   </span><span style=\"color: #808000; text-decoration-color: #808000\">f\"is deprecated since Matplotlib {</span>since<span style=\"color: #808000; text-decoration-color: #808000\">} and will be removed \"</span>      <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">356 │   │   │   │   </span><span style=\"color: #808000; text-decoration-color: #808000\">f\"%(removal)s.  If any parameter follows {</span>name<span style=\"color: #808000; text-decoration-color: #808000\">!r}, they \"</span>           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">357 │   │   │   │   </span><span style=\"color: #808000; text-decoration-color: #808000\">f\"should be pass as keyword, not positionally.\"</span>)                    <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>358 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">return</span> func(*args, **kwargs)                                                <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">359 │   </span>                                                                                <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">360 │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">return</span> wrapper                                                                  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">361 </span>                                                                                    <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/matplotlib/axes/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">_axes.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">5626</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">imshow</span>            <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">5623 │   │   │   │   │   │   │     </span>filternorm=filternorm, filterrad=filterrad,          <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">5624 │   │   │   │   │   │   │     </span>resample=resample, **kwargs)                         <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">5625 │   │   </span>                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>5626 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>im.set_data(X)                                                             <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">5627 │   │   </span>im.set_alpha(alpha)                                                        <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">5628 │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">if</span> im.get_clip_path() <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">is</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff\">None</span>:                                             <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">5629 │   │   │   # image does not already have clipping set, clip to axes patch</span>         <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.7/dist-packages/matplotlib/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">image.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">699</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">set_data</span>                <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>                                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 696 │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">if</span> <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">not</span> (<span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>._A.ndim == <span style=\"color: #0000ff; text-decoration-color: #0000ff\">2</span>                                                  <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 697 │   │   │   │   </span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">or</span> <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>._A.ndim == <span style=\"color: #0000ff; text-decoration-color: #0000ff\">3</span> <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">and</span> <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>._A.shape[-<span style=\"color: #0000ff; text-decoration-color: #0000ff\">1</span>] <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">in</span> [<span style=\"color: #0000ff; text-decoration-color: #0000ff\">3</span>, <span style=\"color: #0000ff; text-decoration-color: #0000ff\">4</span>]):             <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 698 │   │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">raise</span> <span style=\"color: #00ffff; text-decoration-color: #00ffff\">TypeError</span>(<span style=\"color: #808000; text-decoration-color: #808000\">\"Invalid shape {} for image data\"</span>                      <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span> 699 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   │   │   │   │   │   </span>.format(<span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>._A.shape))                                <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 700 │   │   </span>                                                                           <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 701 │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">if</span> <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>._A.ndim == <span style=\"color: #0000ff; text-decoration-color: #0000ff\">3</span>:                                                      <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 702 │   │   │   # If the input data has values outside the valid range (after</span>          <span style=\"color: #ff0000; text-decoration-color: #ff0000\">│</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000\">╰───────────────────────────────────────────────────────────────────────────────────────────╯</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000; font-weight: bold\">TypeError: </span>Invalid shape <span style=\"font-weight: bold\">(</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">224</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">224</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span><span style=\"font-weight: bold\">)</span> for image data\n","</pre>\n"],"text/plain":["\u001b[91m╭─\u001b[0m\u001b[91m─────────────────────────── \u001b[0m\u001b[1;31mTraceback \u001b[0m\u001b[1;2;31m(most recent call last)\u001b[0m\u001b[91m ───────────────────────────\u001b[0m\u001b[91m─╮\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/IPython/core/\u001b[0m\u001b[1;33minteractiveshell.py\u001b[0m:\u001b[94m2882\u001b[0m in \u001b[92mrun_code\u001b[0m  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2879 \u001b[0m\u001b[2m│   │   │   \u001b[0m\u001b[94mtry\u001b[0m:                                                                   \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2880 \u001b[0m\u001b[2m│   │   │   │   \u001b[0m\u001b[96mself\u001b[0m.hooks.pre_run_code_hook()                                     \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2881 \u001b[0m\u001b[2m│   │   │   │   \u001b[0m\u001b[2m#rprint('Running code', repr(code_obj)) # dbg\u001b[0m                      \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m2882 \u001b[2m│   │   │   │   \u001b[0mexec(code_obj, \u001b[96mself\u001b[0m.user_global_ns, \u001b[96mself\u001b[0m.user_ns)                  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2883 \u001b[0m\u001b[2m│   │   │   \u001b[0m\u001b[94mfinally\u001b[0m:                                                               \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2884 \u001b[0m\u001b[2m│   │   │   │   \u001b[0m\u001b[2m# Reset our crash handler in place\u001b[0m                                 \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2885 \u001b[0m\u001b[2m│   │   │   │   \u001b[0msys.excepthook = old_excepthook                                    \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[33m<ipython-input-146-12ba6d47bd7e>\u001b[0m:\u001b[94m1\u001b[0m in \u001b[92m<module>\u001b[0m                                            \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/matplotlib/\u001b[0m\u001b[1;33mpyplot.py\u001b[0m:\u001b[94m2651\u001b[0m in \u001b[92mimshow\u001b[0m                \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2648 \u001b[0m\u001b[2m│   │   \u001b[0mvmax=vmax, origin=origin, extent=extent, shape=shape,                      \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2649 \u001b[0m\u001b[2m│   │   \u001b[0mfilternorm=filternorm, filterrad=filterrad, imlim=imlim,                   \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2650 \u001b[0m\u001b[2m│   │   \u001b[0mresample=resample, url=url, **({\u001b[33m\"\u001b[0m\u001b[33mdata\u001b[0m\u001b[33m\"\u001b[0m: data} \u001b[94mif\u001b[0m data \u001b[95mis\u001b[0m \u001b[95mnot\u001b[0m               \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m2651 \u001b[2m│   │   \u001b[0m\u001b[94mNone\u001b[0m \u001b[94melse\u001b[0m {}), **kwargs)                                                   \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2652 \u001b[0m\u001b[2m│   \u001b[0msci(__ret)                                                                     \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2653 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94mreturn\u001b[0m __ret                                                                   \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m2654 \u001b[0m                                                                                   \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/matplotlib/\u001b[0m\u001b[1;33m__init__.py\u001b[0m:\u001b[94m1565\u001b[0m in \u001b[92minner\u001b[0m               \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1562 \u001b[0m\u001b[2m│   \u001b[0m\u001b[1;95m@functools\u001b[0m.wraps(func)                                                         \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1563 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94mdef\u001b[0m \u001b[92minner\u001b[0m(ax, *args, data=\u001b[94mNone\u001b[0m, **kwargs):                                     \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1564 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[94mif\u001b[0m data \u001b[95mis\u001b[0m \u001b[94mNone\u001b[0m:                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m1565 \u001b[2m│   │   │   \u001b[0m\u001b[94mreturn\u001b[0m func(ax, *\u001b[96mmap\u001b[0m(sanitize_sequence, args), **kwargs)               \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1566 \u001b[0m\u001b[2m│   │   \u001b[0m                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1567 \u001b[0m\u001b[2m│   │   \u001b[0mbound = new_sig.bind(ax, *args, **kwargs)                                  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m1568 \u001b[0m\u001b[2m│   │   \u001b[0mauto_label = (bound.arguments.get(label_namer)                             \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/matplotlib/cbook/\u001b[0m\u001b[1;33mdeprecation.py\u001b[0m:\u001b[94m358\u001b[0m in \u001b[92mwrapper\u001b[0m     \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m355 \u001b[0m\u001b[2m│   │   │   │   \u001b[0m\u001b[33mf\u001b[0m\u001b[33m\"\u001b[0m\u001b[33mis deprecated since Matplotlib \u001b[0m\u001b[33m{\u001b[0msince\u001b[33m}\u001b[0m\u001b[33m and will be removed \u001b[0m\u001b[33m\"\u001b[0m      \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m356 \u001b[0m\u001b[2m│   │   │   │   \u001b[0m\u001b[33mf\u001b[0m\u001b[33m\"\u001b[0m\u001b[33m%(removal)s.  If any parameter follows \u001b[0m\u001b[33m{\u001b[0mname\u001b[33m!r}\u001b[0m\u001b[33m, they \u001b[0m\u001b[33m\"\u001b[0m           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m357 \u001b[0m\u001b[2m│   │   │   │   \u001b[0m\u001b[33mf\u001b[0m\u001b[33m\"\u001b[0m\u001b[33mshould be pass as keyword, not positionally.\u001b[0m\u001b[33m\"\u001b[0m)                    \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m358 \u001b[2m│   │   \u001b[0m\u001b[94mreturn\u001b[0m func(*args, **kwargs)                                                \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m359 \u001b[0m\u001b[2m│   \u001b[0m                                                                                \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m360 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94mreturn\u001b[0m wrapper                                                                  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m361 \u001b[0m                                                                                    \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/matplotlib/cbook/\u001b[0m\u001b[1;33mdeprecation.py\u001b[0m:\u001b[94m358\u001b[0m in \u001b[92mwrapper\u001b[0m     \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m355 \u001b[0m\u001b[2m│   │   │   │   \u001b[0m\u001b[33mf\u001b[0m\u001b[33m\"\u001b[0m\u001b[33mis deprecated since Matplotlib \u001b[0m\u001b[33m{\u001b[0msince\u001b[33m}\u001b[0m\u001b[33m and will be removed \u001b[0m\u001b[33m\"\u001b[0m      \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m356 \u001b[0m\u001b[2m│   │   │   │   \u001b[0m\u001b[33mf\u001b[0m\u001b[33m\"\u001b[0m\u001b[33m%(removal)s.  If any parameter follows \u001b[0m\u001b[33m{\u001b[0mname\u001b[33m!r}\u001b[0m\u001b[33m, they \u001b[0m\u001b[33m\"\u001b[0m           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m357 \u001b[0m\u001b[2m│   │   │   │   \u001b[0m\u001b[33mf\u001b[0m\u001b[33m\"\u001b[0m\u001b[33mshould be pass as keyword, not positionally.\u001b[0m\u001b[33m\"\u001b[0m)                    \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m358 \u001b[2m│   │   \u001b[0m\u001b[94mreturn\u001b[0m func(*args, **kwargs)                                                \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m359 \u001b[0m\u001b[2m│   \u001b[0m                                                                                \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m360 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94mreturn\u001b[0m wrapper                                                                  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m361 \u001b[0m                                                                                    \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/matplotlib/axes/\u001b[0m\u001b[1;33m_axes.py\u001b[0m:\u001b[94m5626\u001b[0m in \u001b[92mimshow\u001b[0m            \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m5623 \u001b[0m\u001b[2m│   │   │   │   │   │   │     \u001b[0mfilternorm=filternorm, filterrad=filterrad,          \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m5624 \u001b[0m\u001b[2m│   │   │   │   │   │   │     \u001b[0mresample=resample, **kwargs)                         \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m5625 \u001b[0m\u001b[2m│   │   \u001b[0m                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m5626 \u001b[2m│   │   \u001b[0mim.set_data(X)                                                             \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m5627 \u001b[0m\u001b[2m│   │   \u001b[0mim.set_alpha(alpha)                                                        \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m5628 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[94mif\u001b[0m im.get_clip_path() \u001b[95mis\u001b[0m \u001b[94mNone\u001b[0m:                                             \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m5629 \u001b[0m\u001b[2m│   │   │   \u001b[0m\u001b[2m# image does not already have clipping set, clip to axes patch\u001b[0m         \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.7/dist-packages/matplotlib/\u001b[0m\u001b[1;33mimage.py\u001b[0m:\u001b[94m699\u001b[0m in \u001b[92mset_data\u001b[0m                \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m                                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m 696 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[94mif\u001b[0m \u001b[95mnot\u001b[0m (\u001b[96mself\u001b[0m._A.ndim == \u001b[94m2\u001b[0m                                                  \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m 697 \u001b[0m\u001b[2m│   │   │   │   \u001b[0m\u001b[95mor\u001b[0m \u001b[96mself\u001b[0m._A.ndim == \u001b[94m3\u001b[0m \u001b[95mand\u001b[0m \u001b[96mself\u001b[0m._A.shape[-\u001b[94m1\u001b[0m] \u001b[95min\u001b[0m [\u001b[94m3\u001b[0m, \u001b[94m4\u001b[0m]):             \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m 698 \u001b[0m\u001b[2m│   │   │   \u001b[0m\u001b[94mraise\u001b[0m \u001b[96mTypeError\u001b[0m(\u001b[33m\"\u001b[0m\u001b[33mInvalid shape \u001b[0m\u001b[33m{}\u001b[0m\u001b[33m for image data\u001b[0m\u001b[33m\"\u001b[0m                      \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m \u001b[31m❱ \u001b[0m 699 \u001b[2m│   │   │   │   │   │   │   \u001b[0m.format(\u001b[96mself\u001b[0m._A.shape))                                \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m 700 \u001b[0m\u001b[2m│   │   \u001b[0m                                                                           \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m 701 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[94mif\u001b[0m \u001b[96mself\u001b[0m._A.ndim == \u001b[94m3\u001b[0m:                                                      \u001b[91m│\u001b[0m\n","\u001b[91m│\u001b[0m   \u001b[2m 702 \u001b[0m\u001b[2m│   │   │   \u001b[0m\u001b[2m# If the input data has values outside the valid range (after\u001b[0m          \u001b[91m│\u001b[0m\n","\u001b[91m╰───────────────────────────────────────────────────────────────────────────────────────────╯\u001b[0m\n","\u001b[1;91mTypeError: \u001b[0mInvalid shape \u001b[1m(\u001b[0m\u001b[1;36m32\u001b[0m, \u001b[1;36m224\u001b[0m, \u001b[1;36m224\u001b[0m, \u001b[1;36m3\u001b[0m\u001b[1m)\u001b[0m for image data\n"]},"metadata":{"tags":[]}},{"output_type":"display_data","data":{"image/png":"iVBORw0KGgoAAAANSUhEUgAAAQYAAAD8CAYAAACVSwr3AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAMbElEQVR4nO3bcYikd33H8ffHXFNpGrWYFeTuNJFeGq+2kHRJU4SaYlouKdz9YZE7CG1KyKE1UlAKKZZU4l9WakG41l6pRAWNp3+UBU8CtZGAeDEbEmPuQmQ9bXNRmjOm/iMaQ7/9YybtZL+7mSd3szO39f2ChXme+e3Md4fhfc8881yqCkma9IpFDyDpwmMYJDWGQVJjGCQ1hkFSYxgkNVPDkOQTSZ5O8tgm9yfJx5KsJXk0yTWzH1PSPA05Yrgb2PcS998I7Bn/HAb+4fzHkrRIU8NQVfcDP3yJJQeAT9XICeA1SV4/qwElzd+OGTzGTuDJie0z433fX78wyWFGRxVccsklv3XVVVfN4Oklbeahhx76QVUtvdzfm0UYBquqo8BRgOXl5VpdXZ3n00s/d5L8+7n83iy+lXgK2D2xvWu8T9I2NYswrAB/PP524jrgR1XVPkZI2j6mfpRI8lngeuCyJGeAvwZ+AaCqPg4cB24C1oAfA3+6VcNKmo+pYaiqQ1PuL+A9M5tI0sJ55aOkxjBIagyDpMYwSGoMg6TGMEhqDIOkxjBIagyDpMYwSGoMg6TGMEhqDIOkxjBIagyDpMYwSGoMg6TGMEhqDIOkxjBIagyDpMYwSGoMg6TGMEhqDIOkxjBIagyDpMYwSGoMg6TGMEhqDIOkxjBIagyDpMYwSGoMg6RmUBiS7EvyRJK1JHdscP8bktyX5OEkjya5afajSpqXqWFIchFwBLgR2AscSrJ33bK/Ao5V1dXAQeDvZz2opPkZcsRwLbBWVaer6jngHuDAujUFvGp8+9XA92Y3oqR5GxKGncCTE9tnxvsmfRC4OckZ4Djw3o0eKMnhJKtJVs+ePXsO40qah1mdfDwE3F1Vu4CbgE8naY9dVUerarmqlpeWlmb01JJmbUgYngJ2T2zvGu+bdCtwDKCqvga8ErhsFgNKmr8hYXgQ2JPkiiQXMzq5uLJuzX8AbwdI8mZGYfCzgrRNTQ1DVT0P3A7cCzzO6NuHk0nuSrJ/vOz9wG1JvgF8Frilqmqrhpa0tXYMWVRVxxmdVJzcd+fE7VPAW2c7mqRF8cpHSY1hkNQYBkmNYZDUGAZJjWGQ1BgGSY1hkNQYBkmNYZDUGAZJjWGQ1BgGSY1hkNQYBkmNYZDUGAZJjWGQ1BgGSY1hkNQYBkmNYZDUGAZJjWGQ1BgGSY1hkNQYBkmNYZDUGAZJjWGQ1BgGSY1hkNQYBkmNYZDUDApDkn1JnkiyluSOTda8M8mpJCeTfGa2Y0qapx3TFiS5CDgC/D5wBngwyUpVnZpYswf4S+CtVfVsktdt1cCStt6QI4ZrgbWqOl1VzwH3AAfWrbkNOFJVzwJU1dOzHVPSPA0Jw07gyYntM+N9k64Erkzy1SQnkuzb6IGSHE6ymmT17Nmz5zaxpC03q5OPO4A9wPXAIeCfkrxm/aKqOlpVy1W1vLS0NKOnljRrQ8LwFLB7YnvXeN+kM8BKVf2sqr4DfItRKCRtQ0PC8CCwJ8kVSS4GDgIr69b8C6OjBZJcxuijxekZzilpjqaGoaqeB24H7gUeB45V1ckkdyXZP152L/BMklPAfcBfVNUzWzW0pK2VqlrIEy8vL9fq6upCnlv6eZHkoapafrm/55WPkhrDIKkxDJIawyCpMQySGsMgqTEMkhrDIKkxDJIawyCpMQySGsMgqTEMkhrDIKkxDJIawyCpMQySGsMgqTEMkhrDIKkxDJIawyCpMQySGsMgqTEMkhrDIKkxDJIawyCpMQySGsMgqTEMkhrDIKkxDJIawyCpMQySmkFhSLIvyRNJ1pLc8RLr3pGkkizPbkRJ8zY1DEkuAo4ANwJ7gUNJ9m6w7lLgz4EHZj2kpPkacsRwLbBWVaer6jngHuDABus+BHwY+MkM55O0AEPCsBN4cmL7zHjf/0pyDbC7qr74Ug+U5HCS1SSrZ8+efdnDSpqP8z75mOQVwEeB909bW1VHq2q5qpaXlpbO96klbZEhYXgK2D2xvWu87wWXAm8BvpLku8B1wIonIKXta0gYHgT2JLkiycXAQWDlhTur6kdVdVlVXV5VlwMngP1VtbolE0vaclPDUFXPA7cD9wKPA8eq6mSSu5Ls3+oBJc3fjiGLquo4cHzdvjs3WXv9+Y8laZG88lFSYxgkNYZBUmMYJDWGQVJjGCQ1hkFSYxgkNYZBUmMYJDWGQVJjGCQ1hkFSYxgkNYZBUmMYJDWGQVJjGCQ1hkFSYxgkNYZBUmMYJDWGQVJjGCQ1hkFSYxgkNYZBUmMYJDWGQVJjGCQ1hkFSYxgkNYZBUmMYJDWDwpBkX5InkqwluWOD+9+X5FSSR5N8OckbZz+qpHmZGoYkFwFHgBuBvcChJHvXLXsYWK6q3wS+APzNrAeVND9DjhiuBdaq6nRVPQfcAxyYXFBV91XVj8ebJ4Bdsx1T0jwNCcNO4MmJ7TPjfZu5FfjSRnckOZxkNcnq2bNnh08paa5mevIxyc3AMvCRje6vqqNVtVxVy0tLS7N8akkztGPAmqeA3RPbu8b7XiTJDcAHgLdV1U9nM56kRRhyxPAgsCfJFUkuBg4CK5MLklwN/COwv6qenv2YkuZpahiq6nngduBe4HHgWFWdTHJXkv3jZR8Bfhn4fJJHkqxs8nCStoEhHyWoquPA8XX77py4fcOM55K0QF75KKkxDJIawyCpMQySGsMgqTEMkhrDIKkxDJIawyCpMQySGsMgqTEMkhrDIKkxDJIawyCpMQySGsMgqTEMkhrDIKkxDJIawyCpMQySGsMgqTEMkhrDIKkxDJIawyCpMQySGsMgqTEMkhrDIKkxDJIawyCpMQySGsMgqRkUhiT7kjyRZC3JHRvc/4tJPje+/4Ekl896UEnzMzUMSS4CjgA3AnuBQ0n2rlt2K/BsVf0q8HfAh2c9qKT5GXLEcC2wVlWnq+o54B7gwLo1B4BPjm9/AXh7ksxuTEnztGPAmp3AkxPbZ4Df3mxNVT2f5EfAa4EfTC5Kchg4PN78aZLHzmXoBbmMdX/PBWw7zQrba97tNCvAr53LLw0Jw8xU1VHgKECS1apanufzn4/tNO92mhW217zbaVYYzXsuvzfko8RTwO6J7V3jfRuuSbIDeDXwzLkMJGnxhoThQWBPkiuSXAwcBFbWrVkB/mR8+4+Af6uqmt2YkuZp6keJ8TmD24F7gYuAT1TVySR3AatVtQL8M/DpJGvADxnFY5qj5zH3ImynebfTrLC95t1Os8I5zhv/YZe0nlc+SmoMg6Rmy8OwnS6nHjDr+5KcSvJoki8neeMi5pyY5yXnnVj3jiSVZGFfsw2ZNck7x6/vySSfmfeM62aZ9l54Q5L7kjw8fj/ctIg5x7N8IsnTm10XlJGPjf+WR5NcM/VBq2rLfhidrPw28CbgYuAbwN51a/4M+Pj49kHgc1s503nO+nvAL41vv3tRsw6dd7zuUuB+4ASwfKHOCuwBHgZ+Zbz9ugv5tWV0Uu/d49t7ge8ucN7fBa4BHtvk/puALwEBrgMemPaYW33EsJ0up546a1XdV1U/Hm+eYHRNx6IMeW0BPsTo/678ZJ7DrTNk1tuAI1X1LEBVPT3nGScNmbeAV41vvxr43hzne/EgVfcz+jZwMweAT9XICeA1SV7/Uo+51WHY6HLqnZutqarngRcup563IbNOupVRhRdl6rzjQ8bdVfXFeQ62gSGv7ZXAlUm+muREkn1zm64bMu8HgZuTnAGOA++dz2jn5OW+t+d7SfT/F0luBpaBty16ls0keQXwUeCWBY8y1A5GHyeuZ3Qkdn+S36iq/1roVJs7BNxdVX+b5HcYXcfzlqr670UPNgtbfcSwnS6nHjIrSW4APgDsr6qfzmm2jUyb91LgLcBXknyX0WfLlQWdgBzy2p4BVqrqZ1X1HeBbjEKxCEPmvRU4BlBVXwNeyeg/WF2IBr23X2SLT4rsAE4DV/B/J3F+fd2a9/Dik4/HFnQCZ8isVzM6KbVnETO+3HnXrf8Kizv5OOS13Qd8cnz7MkaHvq+9gOf9EnDL+PabGZ1jyALfD5ez+cnHP+TFJx+/PvXx5jDwTYzq/23gA+N9dzH6FxdGpf08sAZ8HXjTAl/cabP+K/CfwCPjn5VFzTpk3nVrFxaGga9tGH30OQV8Ezh4Ib+2jL6J+Oo4Go8Af7DAWT8LfB/4GaMjr1uBdwHvmnhtj4z/lm8OeR94SbSkxisfJTWGQVJjGCQ1hkFSYxgkNYZBUmMYJDX/AwqkUdV2nfELAAAAAElFTkSuQmCC\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"tags":[],"needs_background":"light"}}]},{"cell_type":"code","metadata":{"id":"nVsnxOazxEtQ"},"source":[""],"execution_count":null,"outputs":[]}]}